# ![logo](https://i.imgur.com/zqJELkl.png)

<p align="center">
 <img src="https://img.shields.io/badge/License-MIT-blue.svg">
 <img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103">
 <img src="http://ForTheBadge.com/images/badges/built-with-love.svg">
 <img src="https://img.shields.io/badge/badges-awesome-green.svg">
 <img src="https://img.shields.io/badge/Stay-Safe-red?logo=data:image/svg%2bxml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEwIDUxMCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTAgNTEwIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im0xNzQuNjEgMzAwYy0yMC41OCAwLTQwLjU2IDYuOTUtNTYuNjkgMTkuNzJsLTExMC4wOSA4NS43OTd2MTA0LjQ4M2g1My41MjlsNzYuNDcxLTY1aDEyNi44MnYtMTQ1eiIgZmlsbD0iI2ZmZGRjZSIvPjwvZz48cGF0aCBkPSJtNTAyLjE3IDI4NC43MmMwIDguOTUtMy42IDE3Ljg5LTEwLjc4IDI0LjQ2bC0xNDguNTYgMTM1LjgyaC03OC4xOHYtODVoNjguMThsMTE0LjM0LTEwMC4yMWMxMi44Mi0xMS4yMyAzMi4wNi0xMC45MiA0NC41LjczIDcgNi41NSAxMC41IDE1LjM4IDEwLjUgMjQuMnoiIGZpbGw9IiNmZmNjYmQiLz48cGF0aCBkPSJtMzMyLjgzIDM0OS42M3YxMC4zN2gtNjguMTh2LTYwaDE4LjU1YzI3LjQxIDAgNDkuNjMgMjIuMjIgNDkuNjMgNDkuNjN6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTM5OS44IDc3LjN2OC4wMWMwIDIwLjY1LTguMDQgNDAuMDctMjIuNjQgNTQuNjdsLTExMi41MSAxMTIuNTF2LTIyNi42NmwzLjE4LTMuMTljMTQuNi0xNC42IDM0LjAyLTIyLjY0IDU0LjY3LTIyLjY0IDQyLjYyIDAgNzcuMyAzNC42OCA3Ny4zIDc3LjN6IiBmaWxsPSIjZDAwMDUwIi8+PHBhdGggZD0ibTI2NC42NSAyNS44M3YyMjYuNjZsLTExMi41MS0xMTIuNTFjLTE0LjYtMTQuNi0yMi42NC0zNC4wMi0yMi42NC01NC42N3YtOC4wMWMwLTQyLjYyIDM0LjY4LTc3LjMgNzcuMy03Ny4zIDIwLjY1IDAgNDAuMDYgOC4wNCA1NC42NiAyMi42NHoiIGZpbGw9IiNmZjRhNGEiLz48cGF0aCBkPSJtMjEyLjgzIDM2MC4xMnYzMGg1MS44MnYtMzB6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTI2NC42NSAzNjAuMTJ2MzBoMzYuMTRsMzIuMDQtMzB6IiBmaWxsPSIjZmZiZGE5Ii8+PC9nPjwvc3ZnPg==">

</p>
 <p align="center">
     <a href="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge" alt="GitHub Repo stars">
         <img src="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge" alt="GitHub forks">
         <img src="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge" alt="GitHub watchers">
         <img src="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge"></a>
</p>

<p align="center">
 <img src="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/assets/images/awcu.gif" width= "700">

#### _<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>AdGuard</b></a>_: Adblocker para tus dispositivos en casa (<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md#how-does-adguard-home-compare-to-pi-hole"><b>_AdGuard comparado con Pi-Hole_</b></a>)

#### _<a href="https://www.wireguard.com/"><b>Guardia de alambre</b></a>_: Un servidor Vpn en casa accesible desde cualquier red externa (IPv4 e IPv6)

#### _<a href="https://www.nlnetlabs.nl/projects/unbound/about/"><b>Sin consolidar</b></a>con &lt;a href="<https://dnsprivacy.org/dns_privacy_daemon>_-_rechoncho/sobre_rechoncho/"><b>Achaparrado</b></a>_: un solucionador de DNS de validaciÃ³n, recursivo y almacenamiento en cachÃ©

#### _<a href="https://www.cloudflare.com/learning/what-is-cloudflare/"><b>Llamarada de la nube</b></a>_: Mejor rendimiento y seguridad al navegar por sitios web (DoT y DoH)

* * *

# 

<h2 align="left">ğŸ§ª Speed results with <a href="https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/testingdnsusingdig.htm"><b>BIND's DNS Tool </b></a> ğŸ§ª</h1>

<b>Tiempo de consulta (google.com) en milisegundos:</b>

-   Resolutores de DNS predeterminados de Adguard -`60-70 msec`
-   Solucionadores de DNS pÃºblicos de Cloudflare/Quad9/Google -`50-70 msec`
-   Esta instalaciÃ³n/configuraciÃ³n -`5-10 msec`

<details><summary><b>ğŸ¥Video PreviewsğŸ¥<img src="https://media.giphy.com/media/WT5h7PgVSScLLKtMaS/giphy.gif" width=50px height=40px></b></summary>
<p>

### ã€Adguard DNS predeterminadoã€‘<i>VS</i>â­esta configuraciÃ³nâ­ :

<https://user-images.githubusercontent.com/18756975/150230438-b767e86f-4e18-4791-b5fe-0813615a37a3.mp4>

### Resolvedores de DNS pÃºblicosã€cloudflare/quad9/googleã€‘:

<https://user-images.githubusercontent.com/18756975/150319049-3d8acdc9-624f-4b60-8ee2-b80227522252.mp4>

</p>
 </details>

* * *

<h4><p align="center">
â°Last Checked : 25 Feb 2022â°</h2>

<div align="center">

| Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProyectosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â EstadoÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| :---------------------------------------------------------------: | :--------------------------------------------------------: |
|                         Inicio de AdGuard                         |                              âœ…                             |
|                           Sin consolidar                          |                              âœ…                             |
|                        Llamarada de la nube                       |                              âœ…                             |
|                            Achaparrado                            |                              âœ…                             |
|                         Guardia de alambre                        |                              âœ…                             |

</div>
<div>

# 

# Contenido

-   <a href="https://git.io/About">Sobre</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/parrots/party-nyan.gif" width=20px height=20px>
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions">Discusiones/F.A.Q.</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-speech-balloon.png" width=20px height=20px>
-   [Requisitos](#requirements)
-   [InstalaciÃ³n del sistema operativo Pi](#installing-os-image-to-sdcard-)<img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-icon.svg" width=20px height=20px>
    -   [Iniciar sesiÃ³n en el sistema Pi \[sin cabeza\]](#-logging-into-pi-system-headlessly-)
-   [InstalaciÃ³n de AdGuard](#adguard-install-)<img src="https://www.vectorlogo.zone/logos/adguard/adguard-icon.svg" width=20px height=20px>
    -   [Configura tus dispositivos para que funcionen con Adguard](#-set-up-your-devices-to-work-with-adguard-)
    -   [ConfiguraciÃ³n de la lista de bloqueo de AdGuard](#-setting-up-adguard-blocklist-)
        -   [Agregar/Eliminar varias URL a la lista de bloqueo a la vez](#-addremove-multiple-urls-)
-   [InstalaciÃ³n de Unbound](#unbound-install-)<img src="https://www.privacytools.io/img/apps/unbound.svg" width=20px height=20px>
-   [InstalaciÃ³n de Cloudflare](#cloudflare-install-)<img src="https://www.vectorlogo.zone/logos/cloudflare/cloudflare-icon.svg" width=20px height=20px>
    -   [Instalar Cloudflare (DoH)](#-install-cloudflare-on-pi-with-doh-)
    -   [Configurar Cloudflare en Unbound (DoT)](#-configure-cloudflare-on-unbound-with-dot-)
    -   [Configurar Stubby (reenviador TLS)](#-configure-stubby-for-unbound-)
    -   [Configurar AdGuard con Cloudflare (DoH&DoT)](#-configure-adguard-with-cloudflaredohdot-)
-   [InstalaciÃ³n de WireGuard](#wireguard-install-)<img src="https://www.vectorlogo.zone/logos/wireguard/wireguard-icon.svg" width=20px height=20px>o<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md">OpenVPN (mÃ¡s lento)</a><img src="https://i.imgur.com/Agstbe5.png" width=20px height=20px>
    -   [ConexiÃ³n de la VPN al telÃ©fono Android/IOS](#-connecting-to-the-vpn-to-androidios-phone-)
    -   [ConexiÃ³n a la VPN desde una PC (Windows)](#-connecting-to-the-vpn-from-a-pc-windows-)
    -   [Configurar Wireguard con AdGuard/Unbound/Cloudflare](#-configure-wireguard-with-adguardunboundcloudflare-)
        -   [Limitar el trÃ¡fico](#limit-traffic)
        -   [configuraciÃ³n de IPv6](#ipv6)
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md">Deshabilitar todo IPv6</a>
-   [VPN de prueba](#how-do-you-know-if-wireguard-vpn-is-really-working-)<img src="https://i.imgur.com/6Yf8Zra.png" width=20px height=20px>
-   [Actualiza automÃ¡ticamente tu Pi](#auto-update-pi-)
-   [Mejorar la vida Ãºtil potencial de su tarjeta SD](#log2ram-install-)
-   [Apague los LED Pi](#turn-off-pi-led-lights-)
-   [Asegurando su Raspberry Pi](#secure-your-raspberry-pi-)
-   [Recursos del repositorio](#repository-resources)<img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-books.png" width=20px height=20px>

# 

# Requisitos

-   Una versiÃ³n Raspberry Pi 3 o 4
-   Un enrutador que admita el reenvÃ­o de puertos (Most Can)
-   Lector de tarjetas microSD USB
-   Tarjeta MicroSD (8 GB o mÃ¡s, al menos Clase 4)
-   Cable de ethernet
-   (Opcional si usa un monitor) MicroHDMI-(RPi 4) o HDMI-(RPi 3)

    # 

    <p align="center">
      <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 1 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Installing OS Image To SDcard</b></i> </h1>

Este tutorial se basa en el sistema operativo Raspberry Pi, pero puede usar cualquier linux<a href="https://github.com/thibmaek/awesome-raspberry-pi#os-images"><b>Sistema operativo</b></a>(32 bits o 64 bits) y el hardware que prefiera con algunos ajustes_**si sabes lo que haces**_! (Raspberry Pi OS es mÃ¡s simple y recomendado para Pi o para usuarios con mÃ¡s experiencia,_Sistema operativo DietPi_tambiÃ©n se recomienda).

El sistema operativo Raspberry Pi viene en versiones Desktop y Lite (use lite solo para el modo sin cabeza). Puede configurar Raspberry Pi con un monitor/teclado/ratÃ³n, o configurarlo "sin cabeza" desde una terminal.

Instale balenEtcher y descargue la imagen pi para escribir en la tarjeta microSD.

-   Descarga el sistema operativo Raspberry Pi:<https://www.raspberrypi.org/software/operating-systems/>

-   Descarga WhaleEtcher:<https://www.balena.io/etcher/>

despuÃ©s de que tengas`Etcher`instalado y`Raspberry Pi OS`archivo descargado en su computadora, ahora puede insertar la tarjeta SD con lector de tarjetas microSD USB en su computadora.

Inicie Etcher y elija la imagen del sistema operativo Raspberry Pi que descargÃ³, seleccione su tarjeta microSD y haga clic en "Flash".

<p align="center">
 <img src="https://i.imgur.com/tbB3VIK.jpg">

DespuÃ©s de flashear, busque en "Esta PC" un nombre de disco "arranque o unidad USB" (reconecte el lector de tarjetas USB si no se ve). Vaya a ese disco, cree un nuevo archivo de texto llamado**_`ssh without 'txt' extention`_**. TENGA CUIDADO, no es â€œssh.txtâ€, es â€œsshâ€ sin la extensiÃ³n. Debe deshabilitar la opciÃ³n "Ocultar extensiones para tipos de archivo conocidos" en las Opciones del Explorador de archivos si no las ve.

<p align="center">
 <img src="https://i.imgur.com/eV6uMbz.jpg">

Ahora coloque la tarjeta SD en la Raspberry Pi, conecte su cable Ethernet y arranque.

## â•¸ Iniciar sesiÃ³n en el sistema Pi[sin cabeza]â•¸

-   Ahora debe esperar un minuto para que pi se inicie por primera vez.

-   Abra el navegador e inicie sesiÃ³n en la pÃ¡gina del panel de su enrutador

-   Encuentre la lista de todos los dispositivos conectados a su red y copie la direcciÃ³n IP de Raspberry Pi (lo mÃ¡s probable es que tenga el nombre de host`raspberrypi`)

-   Abra Terminal en su mÃ¡quina host. Puede usar PowerShell en Windows o RaspController para Android

Escribe el siguiente comando:

    ssh pi@pi's ip address

Puede usar el botÃ³n derecho del mouse para pegar texto en Windows PowerShell.

Escriba "sÃ­" para la pregunta de huellas dactilares y escriba "frambuesa" para una contraseÃ±a. Las contraseÃ±as serÃ¡n invisibles al escribir en la interfaz de Linux. puedes escribir**_`sudo passwd pi`_**para cambiar la contraseÃ±a.

<p align="center">
 <img src="https://i.imgur.com/Wf30jxG.jpg">

Ejecutar en la terminal:

    sudo apt update -y && sudo apt upgrade -y

__ESPERE A QUE TERMINE LA ACTUALIZACIÃ“N y REINICIE PI. LUEGO CONTINUAR AL SIGUIENTE PASO__.....

    sudo reboot

**[â¬† VOLVER ARRIBA â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 2 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>AdGuard Install</b></i> </h1>

Este script de instalaciÃ³n es de<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>Inicio de AdGuard</b></a>proyecto principal Siga para mantenerse actualizado.

Ejecute el siguiente comando en su terminal:

    curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v

-   Cuando finalice la instalaciÃ³n, aparecerÃ¡ una ventana en la terminal que muestra los diferentes enlaces a la pÃ¡gina de inicio de SU Adguard (Comenzar)

-   `IMPORTANT:`En la opciÃ³n Escuchar interfaces, elija`Eth0`y seleccione siguiente

<p align="center">
  <img src="https://i.imgur.com/Wa00lDp.jpg" width=580px height=690px>

-   Configurar nombre de usuario y contraseÃ±a

-   Ahora deberÃ­a estar en el panel de inicio de Adguard

-   `IMPORTANT:`En la configuraciÃ³n general, establezca "RetenciÃ³n de registros de consultas" en`24 hours`(LeÃ­ que para algunas personas los registros se llenan y ralentizan pi y necesitan reiniciarse cada vez)

## â•¸ Configure sus dispositivos para que funcionen con Adguard â•¸

-   Para Android/Apple, vaya a la configuraciÃ³n avanzada de wifi y seleccione la opciÃ³n estÃ¡tica. En`DNS 1`campo ingrese la direcciÃ³n "ip de pi"

    <p align="center">
     <img src="https://i.imgur.com/nxpiqDw.jpg" width=450px height=580px>

-   Para PC/Windows

    -   <i>IPV4</i>

        Vaya a la configuraciÃ³n de red/cambie las opciones del adaptador y haga clic con el botÃ³n derecho en las propiedades y luego seleccione "Protocolo de Internet versiÃ³n 4 (TCP/IPv4)". Ingrese la direcciÃ³n IP de pi en`Preferred DNS`servidor

    -   <i>IPV6 (necesario para`DoH`&`DoT`para trabajar mÃ¡s adelante en la guÃ­a si usa ipv6 en su enrutador)</i>

        Vaya a "Protocolo de Internet versiÃ³n 6 (TCP/IPv6)" Entrar`::1`

`OPTIONAL:`<i>Puede agregar un dns de respaldo en los campos alternativos</i>

`BE AWARE:`<i>En android, agregar un dns pÃºblico en el segundo campo rompe el bloqueo de anuncios de Adguard</i>

<p align="center">
 <img src="https://i.imgur.com/8gsDk3z.jpg">

## â•¸ ConfiguraciÃ³n de la lista de bloqueo de AdGuard â•¸

En la pÃ¡gina de inicio de AdGuard en filtros, seleccione la secciÃ³n de lista de bloqueo de DNS para agregar direcciones URL.

<p align="center">
 <img src="https://i.imgur.com/shrtJLD.png">

Puede buscar en Google diferentes listas de bloqueo. AquÃ­ estÃ¡ mi lista personalizada<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/My-Blocklist.txt"><b>lista de bloqueos</b></a>con mis URL o crea las tuyas propias a partir de estas<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/%F0%9F%A7%B1Blocklist-Sources%E2%84%B9%EF%B8%8F"><b>fuentes</b></a>.

`IMPORTANT:`Algunas listas de bloqueo pueden bloquear algunos contenidos o sitios web importantes. Para desbloquear vaya a la secciÃ³n "Query Log" y verÃ¡_desatascar_opciÃ³n cuando el cursor se desplaza sobre una consulta, colocando los sitios web desbloqueados en el ejemplo de "Reglas de filtrado personalizadas":`@@||bitly.com^$important`. Busque la IP y la hora del cliente.

<p align="center">
 <img src="https://i.imgur.com/1gZibwD.png">

## â•¸ Agregar/eliminar mÃºltiples URL â•¸

Solo puede agregar una URL por una en la lista de bloqueo de dns en adguard por ahora, pero hay una secuencia de comandos de python para agregar varias URL juntas.

Abra un nuevo archivo py (bulkurls.py):

    nano bulkurls.py

Luego copie y pegue el texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/bulkurls.py"><b>bulkurls.py</b></a>archivar y guardar (control+x luego y luego enter)**NECESITA CONFIGURAR SUS CREDENCIALES DE ADGUARD EN EL ARCHIVO**.

_si usa**DietPi**Instalar en pc`sudo apt-get install python3-pip -y && pip install requests`porque no se instala por defecto._

Correr :`sudo python3 bulkurls.py`

Para**retirar**necesitas cambiar`add`en<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/62ba01ed8ed3a5bc5294b9fe7ee38c3e83ae1b86/bulkurls.py#L150"><b>segunda de la Ãºltima lÃ­nea</b></a>para`remove`en el archivo bulkurls.py.

Ir a<https://d3ward.github.io/toolz/adblock.html>para probar si los anuncios estÃ¡n bloqueando<img src="https://i.imgur.com/Q5oO9EY.png" width=100px height=80px>

**[â¬† VOLVER ARRIBA â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 3 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Unbound Install</b></i> </h1>

Ejecute el siguiente comando en su terminal:

    sudo apt install unbound -y

Para consultar recursivamente un host que no estÃ¡ almacenado en cachÃ© como una direcciÃ³n, el resolutor debe comenzar en la parte superior del Ã¡rbol de servidores y consultar los servidores raÃ­z, para saber a dÃ³nde ir para el dominio de nivel superior para la direcciÃ³n que se consulta. Unbound viene con sugerencias integradas predeterminadas.

    wget -O root.hints https://www.internic.net/domain/named.root && sudo mv root.hints /var/lib/unbound/

`IMPORTANT:`Esto necesita actualizarse cada 6 meses. Para_**actualizaciÃ³n automÃ¡tica**_root.hints cada 6 meses necesita crear un trabajo cron.

Entrar en lÃ­nea de comando`crontab -e`, le pedirÃ¡ Seleccione un editor (elija 1) y pegue estas lÃ­neas en la parte inferior de crontab y guarde (control + x luego y luego ingrese):

    1 0 1 */6 * wget -O root.hints https://www.internic.net/domain/named.root
    2 0 1 */6 * sudo mv root.hints /var/lib/unbound/

_si usa**DietPi**debe instalar resolvconf y reiniciar unbound-resolvconf.service para configurar el servidor de nombres independiente en 127.0.0.1:_

    sudo apt-get install resolvconf -y && sudo systemctl restart unbound-resolvconf.service

<p align="center">
 <img src="https://i.imgur.com/26ro62t.jpg">

**[â¬† VOLVER ARRIBA â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 4 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>   

<h1 align="center"><b><i>Cloudflare Install</b></i> </h1>

## â•¸ Instalar Cloudflare en Pi con`(DoH)`â•¸

Instale cloudflare con DNS sobre HTTPS (DoH), siga estos ğŸ‘‰<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Cloudflare-DoH-Setup.md"><b>INSTRUCCIONES</b></a>ğŸ‘ˆ.

## â•¸ Configurar Cloudflare en Sin vincular con`(DoT)`â•¸

Cree un archivo de configuraciÃ³n independiente ingresando en el sÃ­mbolo del sistema:

    sudo nano /etc/unbound/unbound.conf.d/unbound.conf

Y copie y pegue todo el texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/unbound.conf"><b>desatado.conf</b></a>archivo y guardar (control+x luego y luego enter).

## â•¸ Configurar Stubby para Unbound â•¸

Use Unbound para el almacenamiento en cachÃ© y stubby para el reenviador TLS. Instalar rechoncho:

    sudo apt install stubby -y

Elimine y vuelva a crear el archivo stubby.yaml y copie/pegue todo el texto de<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/stubby.yml"><b>ğŸ‘‰ esta configuraciÃ³n rechoncha ğŸ‘ˆ</b></a>y guardar. (`cd $h`para volver a la carpeta de inicio cuando termine).

    cd /etc/stubby/ && sudo rm stubby.yml && sudo nano stubby.yml

-   Reinicie sin vincular y rechoncho y verifique el estado:


    sudo systemctl restart unbound stubby ; systemctl status unbound stubby -l

<p align="center">
 <img src="https://i.imgur.com/7zIpWP2.jpg" width=650px height=370px>

## â•¸ Configurar Adguard con`Cloudflare(DoH&DoT)`â•¸

-   En la pÃ¡gina de inicio de AdGuard, en la configuraciÃ³n, seleccione "ConfiguraciÃ³n de Dns"

-   Elimine todo desde las opciones de servidor "Upstream" y "Bootstrap DNS" y:

    -   Para`DNS over TLS(DoT)`agregar`127.0.0.1:53`en los campos de servidor "Upstream" y "Bootstrap DNS"
    -   Para`DNS over HTTPS(DoH)`agregar`127.0.0.1:5053`en los campos de servidor "Upstream" y "Bootstrap DNS"
    -   Para`TLS forwarder(stubby)`agregar`127.0.0.1:8053`en los campos de servidor "Upstream" y "Bootstrap DNS"

-   `IMPORTANT:`Tienes que comprobar "<a href="https://adguard.com/en/blog/in-depth-review-adguard-home.html#dns"><b>Solicitud paralela</b></a>"opciÃ³n para que los resolutores de dns funcionen simultÃ¡neamente.

<b>Haga clic en aplicar y probar aguas arriba</b>(podrÃ­a obtener un error en la primera prueba solamente).

<p align="center">
 <img src="https://i.imgur.com/Ug4Euou.jpg" width=650px height=370px>

-   Luego, en la configuraciÃ³n de DNS, busque la secciÃ³n de configuraciÃ³n de cachÃ© de DNS y establezca el tamaÃ±o de cachÃ© en`0`(el almacenamiento en cachÃ© ya lo maneja Unbound) y haga clic en aplicar.

<p align="center">
 <img src="https://i.imgur.com/8Q5Zb0M.jpg" width=650px height=370px>

### `IMPORTANT:`El sistema de Windows y los navegadores de Android necesitan algunos ajustes para`stabilize`resolutores dns...Linux funciona bien<i>(probado en menta)</i>

### ventanas

-   Instalar<a href="https://mayakron.altervista.org/support/acrylic/Home.htm"><b>Proxy DNS acrÃ­lico</b></a>

-   Ir a`C:\Program Files (x86)\Acrylic DNS Proxy`y abierto`AcrylicConfiguration.ini`expediente. Eliminar todo y copiar estos<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/AcrylicConfiguration.ini"><b>ğŸ‘‰AJUSTESğŸ‘ˆ</b></a>solo cambio_**PrimaryServerAddres**_a la direcciÃ³n de tu pi.

-   En la misma carpeta ejecutar`RestartAcrylicService.bat`&`PurgeAcrylicCacheData.bat`

    `TIP:`Solucionar problemas de comandos IP/DNS

        ipconfig /release
        ipconfig /renew
        ipconfig /flushdns

### Android

-   En cualquier navegador que utilices, activa**apagado**`Use Secure DNS`opciÃ³n.
-   Tenga en cuenta que pueden ocurrir conflictos con roms y nÃºcleos rooteados personalizados con ajustes de build.prop dns o aplicaciones/mÃ³dulo Magisk.

#### _Eso es todo_. ahora ve a<https://1.1.1.1/help>en el navegador y deberÃ­a ver que estas opciones dan como resultado 'SÃ­'.

-   [x] Conectado a 1.1.1.1
-   [x] DNS sobre HTTPS (DoH)
-   [x] DNS sobre TLS (DoT)
-   [ ] DNS sobre WARP
    <p align="center">
     <img src="https://i.imgur.com/2S3IH5H.jpg" width=650px height=370px>

#### Otros sitios para comprobar la seguridad

<https://browserleaks.com/dns>- deberÃ­a mostrar todos los conectados a "Cloudflare"

<https://www.cloudflare.com/ssl/encrypted-sni/>- "Secure DNS / DNSSEC / TLS 1.3" deberÃ­a ser una marca verde

<https://dnssec.vs.uni-due.de/>- debe decir "SÃ­, su sistema de resoluciÃ³n de DNS valida las firmas de DNSSEC"

**[â¬† VOLVER ARRIBA â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 5 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>WireGuard Install</b></i> </h1>

**Antes de instalar WireGuard**, si no tienes una ip estÃ¡tica necesitas obtener una gratis`Dynamic DNS Subdomain`o de lo contrario, su direcciÃ³n IP externa probablemente cambie dinÃ¡micamente desde su ISP con cierta frecuencia y, por esa razÃ³n, deberÃ¡ configurar un servicio de DNS dinÃ¡mico. ğŸ‘‰ğŸ‘‰**_â–“â–’â–‘Usa esto<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>INSTRUCCIONES AQUÃ</b></a>â–‘â–’â–“_**ğŸ‘ˆğŸ‘ˆ. O bien, omita el paso.

TambiÃ©n necesitamos configurar el reenvÃ­o de puertos en su enrutador para que podamos acceder a Wireguard fuera de nuestra red, como en un punto de acceso de una cafeterÃ­a o sus datos mÃ³viles.
TIPO | VALOR  
------------ \| -------------
Dispositivo | Nombre de host o IP de Raspberry Pi
Protocolo | UDP
Gama de puertos | 51820-51820
Puerto de salida | 51820
Permitir acceso a Internet (si tiene) | sÃ­

ConfiguraciÃ³n del puerto de mi ğŸ‘‡routerğŸ‘‡. El tuyo puede ser diferente, pero lo obtendrÃ¡s. Recuerda que Google ğŸ”motor de bÃºsquedağŸ” es tu amigo. Si no puede conectarse desde una red externa, lo que significa que ISP ha bloqueado las conexiones salientes, puede llamarlos y pedir amablemente que funcione.

<p align="center">
 <img src="https://i.imgur.com/9LBEk1i.jpg">

* * *

ğŸ‘ŠMUCHAS GRACIASğŸ‘Š por este script de instalaciÃ³n de<a href="https://github.com/Nyr/wireguard-install"><b>Nyr</b></a>. Siga para mantenerse actualizado.

Ejecutar en la terminal

    wget https://git.io/wireguard -O wireguard-install.sh && sudo bash wireguard-install.sh

-   El script le pedirÃ¡ IPv4/nombre de host pÃºblico para la VPN._Si_tiene ip estÃ¡tica, luego continÃºe o escriba el dominio DNS dinÃ¡mico que creÃ³ desde el<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>instrucciones</b></a>. Por ejemplo: trinibvpn.freeddns.org

-   Para la opciÃ³n de puerto`press enter`para el valor predeterminado 51820. Para el nombre del cliente, solo ingrese el nombre que desee, y para el uso de DNS, la opciÃ³n 3 (`1.1.1.1`) por ahora. vamos a configurar`adguard/unbound/cloudflare`con el vpn despuÃ©s de que haya terminado de instalarse

<p align="center">
 <img src="https://i.imgur.com/WUNZIK4.jpg">

-   Espere hasta que finalice la instalaciÃ³n y se muestre el cÃ³digo QR, no cierre. Pero si lo haces, para`regenerate qrcode`, ingrese en la terminal pero reemplazando solo el nombre`yourclientname.conf`archivo al tuyo:


    sudo cp /root/yourclientname.conf /home/pi && sudo qrencode -t ansiutf8 < yourclientname.conf

`IMPORTANT:`DeberÃ¡ agregar un nuevo usuario/cliente para cada dispositivo que use con la VPN. Para agregar un nuevo usuario, simplemente vuelva a ejecutar el script y cree un usuario con un nombre de cliente diferente.

## Si quieres usar_OpenVPN_las instrucciones son<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md"><b>ğŸ‘‰aquÃ­ğŸ‘ˆ</b></a>

# 

### â•¸ ConexiÃ³n a la VPN a un telÃ©fono Android/IOS â•¸

Instale la aplicaciÃ³n WireGuard desde Google Play o App Store

Wireguard (Google Play):<https://play.google.com/store/apps/details?id=com.wireguard.android>

Wireguard (tienda de aplicaciones):<https://apps.apple.com/us/app/wireguard/id1441195209>

Debe escanear el cÃ³digo QR que se muestra en la terminal con la aplicaciÃ³n Wireguard, seleccione el`+ button`y usa la opcion`Scan from QR code`para instalar la configuraciÃ³n.

`IMPORTANT`: Permitir**back-end del mÃ³dulo del kernel**en la configuraciÃ³n de

<p align="left">
 <img src="https://i.imgur.com/R4qbiOQ.jpg" width=250px height=350px>

### â•¸ ConexiÃ³n a la VPN desde una PC (Windows) â•¸

WireGuard para ventanas:<https://download.wireguard.com/windows-client/wireguard-installer.exe>

-   Crear un`new text document`con cualquier nombre en la PC para copiar y pegar el texto del archivo de configuraciÃ³n del cliente de wireguard.

-   Para ver el texto en el archivo de configuraciÃ³n del cliente, escriba en la terminal:


    sudo cat /root/yourclientname.conf

-   Resalte todo el texto, cÃ³pielo y pÃ©guelo en el archivo txt en la PC y guÃ¡rdelo. Luego cambie el nombre de la extensiÃ³n de`txt`para`conf`. Ahora tiene un archivo de configuraciÃ³n para ese cliente de wireguard.

-   Ahora puede importar el archivo de configuraciÃ³n a wireguard (opciÃ³n importar desde archivo).

## â•¸ Configurar WireGuard con`Adguard/Unbound/Cloudflare`â•¸

_Recuerde que esto es para cuando estÃ© conectado a WireGuard VPN en una red externa o en casa las 24 horas del dÃ­a, los 7 dÃ­as de la semana porque ya tiene AdGuard/Unbound/Cloudflare configurado y ejecutÃ¡ndose en sus dispositivos manualmente._(no hay problema en tener ambos configurados para mi experiencia).

-   En la aplicaciÃ³n wireguard, seleccione su tÃºnel y seleccione editar (lÃ¡piz en la parte superior derecha)

-   En Servidores Dns ingrese`pi's ip`y guardar (IPv4 e IPv6)

<p align="center">
 <img src="https://i.imgur.com/UC0vWfE.jpg" width=450px height=500px>  

### Limitar el trÃ¡fico

Con WireGuard, perderÃ¡ aproximadamente el 50 % de la velocidad de Internet debido al proceso de tunelizaciÃ³n a travÃ©s de pi al enrutador y a los dispositivos\*\*

Elimine en las IP permitidas la opciÃ³n "0.0.0.0/0, ::/0" porque enruta todo el trÃ¡fico a su red domÃ©stica, que serÃ¡ lenta. Solo necesita enviar trÃ¡fico a travÃ©s de sus direcciones.

-   Primero debe reemplazarlo con su puerta de enlace de red, pero configurando el Ãºltimo nÃºmero en cero y<a href="https://www.google.com/search?q=prefix+length+explained&client=firefox-b-d&sxsrf=ALeKk036Jc9vJl73zVXf0yyZs5UlKRlNRQ%3A1621083125589&ei=9cOfYI66I5-qwbkPkdWxkAk&oq=prefix+length+explained&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAcQHjoHCCMQsAMQJzoHCAAQRxCwA1CUJ1iUJ2CiKmgBcAJ4AIABsAGIAdQCkgEDMC4ymAEAoAEBqgEHZ3dzLXdpesgBCcABAQ&sclient=gws-wiz&ved=0ahUKEwjOiOie3cvwAhUfVTABHZFqDJIQ4dUDCA0&uact=5"><b>longitud del prefijo</b></a>a 24. Por ejemplo:`192.168.1.1/24`para`192.168.1.0/24`o como mi enrutador isp`192.168.100.1/24`para`192.168.100.0/24`.~~**Ahora solo pierdo un 25% de velocidad**ğŸ˜ (ps. usando la red 5g)~~

`UPDATE:`DespuÃ©s de una actualizaciÃ³n de Wireguard, no obtengo una velocidad mÃ¡s rÃ¡pida al hacer esto :( .. pero aÃºn tiene sentido_no_usar`"0.0.0.0/0, ::/0`con wifi Si alguien sabe algÃºn ajuste para obtener un impulso, hÃ¡gamelo saber.

<p align="center">
 <img src="https://i.imgur.com/x4m6Pbl.jpg" width=450px height=500px>

### POR FAVOR LEE !! , TENGA EN CUENTA !!

`IMPORTANT`:_Si su red tiene direcciones IP para dispositivos que terminan con un nÃºmero de 3 dÃ­gitos (mÃ¡s de 24), por ejemplo: 192.168.100.`999`, no podrÃ¡ enrutar correctamente desde una red externa porque aplicar 24 solo permite los nÃºmeros del 1 al 24. En su lugar, debe poner`0`para enrutar fuera del rango de 24, por ejemplo:`192.168.100.0/0`_.

O puede cambiar el rango de IP en su enrutador (en mi experiencia, puede obtener velocidades un poco mejores porque no enrutarÃ¡ direcciones IP permitidas innecesarias en el rango de 24).

<p align="center">
 <img src="https://i.imgur.com/ZZ4aMUI.jpg" width=750px height=550px>

## IPV6

Si estÃ¡ utilizando IPv6, cuando estÃ© conectado a wifi, debe ingresar las IP permitidas de WireGuard`fe80::1/0`asÃ­ como. Por ejemplo`192.168.100.0/0, fe80::1/0`

Cuando se conecta al cable ethernet en una PC con Windows, debe ingresar`::1`en la direcciÃ³n IPv6 en el servidor DNS preferido de "Protocolo de Internet versiÃ³n 6 (TCP/IPv6)".

Luego ve a<https://ipv6leak.com/>y deberÃ­as ver"_Su IPv6 no tiene fugas_".

# 

<h1 align="left"><a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md"><b>Disable all IPv6</b></a></h2>

# 

## Â¿CÃ³mo saber si Wireguard VPN realmente funciona?

Para**ventanas**descargar<a href="https://www.wireshark.org/#download."><b>TiburÃ³n alambre</b></a>

Una vez descargada, puede usar la aplicaciÃ³n para inspeccionar sus paquetes de datos donde el protocolo estÃ¡ configurado como el que usa Wireguard VPN. Cuando un trÃ¡fico de paquetes es`encrypted`, se puede leer asÃ­ por ejemplo:

<p align="center">
 <img src="https://i.imgur.com/Tn4M47R.jpg">

Para**android**puedes usar<a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture&hl=en&gl=US"><b>PCAPdroide</b></a>. DeberÃ­as ver todas las conexiones.`closed`y el estado que muestra todas las conexiones DNS y no TLS en todas las aplicaciones (abra y use aplicaciones para que PCAPdroid las escanee).

**[â¬† VOLVER ARRIBA â¬†](#contents)**

* * *

# 

<h1 align="center"><b><i>Auto Update Pi</b></i> </h1>

-   Abra un nuevo archivo sh llamado actualizaciÃ³n y copie y pegue el texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/update.sh"><b>ğŸ‘‰aquÃ­ğŸ‘ˆ</b></a>


    sudo nano update.sh

-   Establecer permiso


    sudo chmod 700 update.sh

-   Abra el archivo cron ingresando en la lÃ­nea de comando`crontab -e`, copie la lÃ­nea de comando de trabajo de pegado a continuaciÃ³n en la parte inferior del archivo cron y guÃ¡rdela.


    0 3 * * WED sudo ./update.sh 2>&1 >/home/pi/updatelog

Pi ahora se actualizarÃ¡ todos los miÃ©rcoles a las 3 am. o puedes ir a<https://crontab.guru/>y establezca su propio horario.

Ajuste la fecha/zona horaria de pi en la terminal:

    sudo dpkg-reconfigure tzdata

o establecer manualmente

    sudo date -s "25 DEC 2012 11:14:00"

# 

<h1 align="center"><b><i>Log2Ram Install</b></i> </h1>

Una de las ventajas mÃ¡s significativas de descargar su RAM es que mejora su**Vida Ãºtil potencial de la tarjeta SD**.
Los archivos de registro son una de las cosas que mÃ¡s escriben las diversas piezas de software que instala.
Al enviar los archivos a su RAM, puede controlar la frecuencia con la que se escriben en la tarjeta SD. AÃºn podrÃ¡ acceder a estos archivos en la RAM como si estuvieran en su tarjeta SD.

Copie y pegue esta lÃ­nea en la terminal:

A mano

    wget https://git.io/log2ram -O Log2Ram-Script.sh && sudo chmod +x Log2Ram-Script.sh && sudo ./Log2Ram-Script.sh

o

Agregar fuente de repositorio (actualizaciÃ³n automÃ¡tica)

    echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian/ bullseye main" | sudo tee /etc/apt/sources.list.d/azlux.list
    sudo wget -O /usr/share/keyrings/azlux-archive-keyring.gpg  https://azlux.fr/repo.gpg
    sudo apt update
    sudo apt install log2ram

# 

<h1 align="center"><b><i>Turn Off Pi LED Lights</b></i> </h1>

Supongo que la alimentaciÃ³n de los LED afectarÃ¡ a la electricidad y el calor innecesarios ğŸ¤·ğŸ˜…. De todos modos, no es necesario si solo lo usa como servidor de red. Abra el archivo cron ingresando en la lÃ­nea de comando`crontab -e`, copie la lÃ­nea de comando de trabajo de pegado a continuaciÃ³n en la parte inferior del archivo cron y guÃ¡rdela.

Verde

    @reboot echo none | sudo tee /sys/class/leds/led0/trigger

Red

    @reboot echo none | sudo tee /sys/class/leds/led1/trigger

Reinicia pi.

# 

<h1 align="center"><b><i>Secure Your Raspberry Pi</b></i> </h1>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><img src="https://i.imgur.com/a9JQVls.png" width=80px height=90px></a>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><b>LINK</b></a>

<i>(Solo uso Fail2Ban y cambio el puerto SSH)</i>

**[â¬† VOLVER ARRIBA â¬†](#contents)**

* * *

<p align="center">
<b>ğŸ‰ğŸ‰ THAT'S IT !! ğŸ‰ğŸ‰ YOUR FINISH ğŸ‘ŒğŸ‘Œ
<p align="center">
<b>ANY ISSUES, FIXES OR TIPS TO MAKE THESE PROJECTS BETTER PLEASE CONTRIBUTEğŸ¤–</b>

* * *

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"
<br> 
<br> 
<br> 

<p align="center">
 <img src="https://i.imgur.com/Q07E7SW.gif" width=500px height=30px>

<p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/stargazers"><img src="https://reporoster.com/stars/dark/trinib/AdGuard-WireGuard-Unbound-Cloudflare"></a>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" </p>

# 

## _Recursos del repositorio_

<h5 https://www.raspberrypi.com/documentation/

<https://github.com/AdguardTeam/AdGuardHome/wiki/Getting-Started>

<https://developers.cloudflare.com/>

<https://docs.pi-hole.net/guides/dns/cloudflared/>

<https://docs.pi-hole.net/guides/dns/unbound/>

<https://nlnetlabs.nl/documentation/unbound/unbound.conf/>

<https://dnsprivacy.org/dns_privacy_clients/>

<https://github.com/anudeepND/pihole-unbound>

<https://github.com/stong/unbound.conf.d>

<https://github.com/Nyr/wireguard-install>

<https://github.com/azlux/log2ram>

* * *

<h4

Preguntas frecuentes:<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions/17"><b>ENLACE</b></a>
