# ![logo](https://i.imgur.com/zqJELkl.png)

<p align="center">
 <img src="https://img.shields.io/badge/License-MIT-blue.svg">
 <img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103">
 <img src="http://ForTheBadge.com/images/badges/built-with-love.svg">
 <img src="https://img.shields.io/badge/badges-awesome-green.svg">
 <img src="https://img.shields.io/badge/Stay-Safe-red?logo=data:image/svg%2bxml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEwIDUxMCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTAgNTEwIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im0xNzQuNjEgMzAwYy0yMC41OCAwLTQwLjU2IDYuOTUtNTYuNjkgMTkuNzJsLTExMC4wOSA4NS43OTd2MTA0LjQ4M2g1My41MjlsNzYuNDcxLTY1aDEyNi44MnYtMTQ1eiIgZmlsbD0iI2ZmZGRjZSIvPjwvZz48cGF0aCBkPSJtNTAyLjE3IDI4NC43MmMwIDguOTUtMy42IDE3Ljg5LTEwLjc4IDI0LjQ2bC0xNDguNTYgMTM1LjgyaC03OC4xOHYtODVoNjguMThsMTE0LjM0LTEwMC4yMWMxMi44Mi0xMS4yMyAzMi4wNi0xMC45MiA0NC41LjczIDcgNi41NSAxMC41IDE1LjM4IDEwLjUgMjQuMnoiIGZpbGw9IiNmZmNjYmQiLz48cGF0aCBkPSJtMzMyLjgzIDM0OS42M3YxMC4zN2gtNjguMTh2LTYwaDE4LjU1YzI3LjQxIDAgNDkuNjMgMjIuMjIgNDkuNjMgNDkuNjN6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTM5OS44IDc3LjN2OC4wMWMwIDIwLjY1LTguMDQgNDAuMDctMjIuNjQgNTQuNjdsLTExMi41MSAxMTIuNTF2LTIyNi42NmwzLjE4LTMuMTljMTQuNi0xNC42IDM0LjAyLTIyLjY0IDU0LjY3LTIyLjY0IDQyLjYyIDAgNzcuMyAzNC42OCA3Ny4zIDc3LjN6IiBmaWxsPSIjZDAwMDUwIi8+PHBhdGggZD0ibTI2NC42NSAyNS44M3YyMjYuNjZsLTExMi41MS0xMTIuNTFjLTE0LjYtMTQuNi0yMi42NC0zNC4wMi0yMi42NC01NC42N3YtOC4wMWMwLTQyLjYyIDM0LjY4LTc3LjMgNzcuMy03Ny4zIDIwLjY1IDAgNDAuMDYgOC4wNCA1NC42NiAyMi42NHoiIGZpbGw9IiNmZjRhNGEiLz48cGF0aCBkPSJtMjEyLjgzIDM2MC4xMnYzMGg1MS44MnYtMzB6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTI2NC42NSAzNjAuMTJ2MzBoMzYuMTRsMzIuMDQtMzB6IiBmaWxsPSIjZmZiZGE5Ii8+PC9nPjwvc3ZnPg==">

</p>
 <p align="center">
     <a href="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge" alt="GitHub Repo stars">
         <img src="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge" alt="GitHub forks">
         <img src="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge" alt="GitHub watchers">
         <img src="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge"></a>
</p>

<p align="center">
 <img src="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/assets/images/awcu.gif" width= "700">

<h1 align="center"><b>A step by step 📜 guide for these</b> 
<h1 align="center"><b> 🅵🆁🅴🅴 network 📡 security projects to work together on a</b>
<h1 align="center"><b>𝓡 𝓐 𝓢 𝓟 𝓑 𝓔 𝓡 𝓡 𝓨 ℙ 𝕀 🥧</b></h1>

#### _<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>AdGuard</b></a>_⫸ Adblocker per i tuoi dispositivi di casa (<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md#how-does-adguard-home-compare-to-pi-hole"><b>_AdGuard rispetto a Pi-Hole_</b></a>)

#### _<a href="https://www.wireguard.com/"><b>WireGuard</b></a>_⫸ Un server VPN a casa accessibile da qualsiasi rete esterna (IPv4 e IPv6)

#### _<a href="https://www.nlnetlabs.nl/projects/unbound/about/"><b>Non vincolato</b></a>con &lt;a href="<https://dnsprivacy.org/dns_privacy_daemon>_-_stubby/about_stubby/"><b>Tozzo</b></a>_⫸ Un risolutore DNS di convalida, ricorsivo e con memorizzazione nella cache

#### _<a href="https://www.cloudflare.com/learning/what-is-cloudflare/"><b>Cloudflare</b></a>_⫸ Migliori prestazioni e sicurezza durante la navigazione nei siti Web (DoT e DoH)

* * *

# 

<h1 align="center">🧪 Speed results with <a href="https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/testingdnsusingdig.htm"><b>BIND's DNS Tool </b></a> 🧪</h1>

<b>Tempo di query (google.com) in millisecondi:</b>

-   Adguard risolutori DNS predefiniti -`60-70 msec`
-   Risolutori DNS Cloudflare/Quad9/Google pubblici -`50-70 msec`
-   Questa impostazione/configurazione -`5-10 msec`

<details><summary><b>🎥Video Previews🎥<img src="https://media.giphy.com/media/WT5h7PgVSScLLKtMaS/giphy.gif" width=50px height=40px></b></summary>
<p>

### 【Adguard DNS predefinito】<i>VS</i>⭐questa configurazione⭐ :

<https://user-images.githubusercontent.com/18756975/150230438-b767e86f-4e18-4791-b5fe-0813615a37a3.mp4>

### Pubblico【cloudflare/quad9/google】Resolver DNS:

<https://user-images.githubusercontent.com/18756975/150319049-3d8acdc9-624f-4b60-8ee2-b80227522252.mp4>

</p>
 </details>

* * *

<h4><p align="center">
⏰Last Checked : 25 Feb 2022⏰</h2>

<div align="center">

|                             Progetti                             |                           Stato                           |
| :--------------------------------------------------------------: | :-------------------------------------------------------: |
|                           AdGuard Casa                           |                             ✅                             |
|                           Non vincolato                          |                             ✅                             |
|                            Cloudflare                            |                             ✅                             |
|                               Tozzo                              |                             ✅                             |
|                             WireGuard                            |                             ✅                             |

</div>
<div>

# 

# Contenuti

-   <a href="https://git.io/About">Di</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/parrots/party-nyan.gif" width=20px height=20px>
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions">Discussioni/F.A.Q</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-speech-balloon.png" width=20px height=20px>
-   [Requisiti](#requirements)
-   [Installazione del sistema operativo Pi](#installing-os-image-to-sdcard-)<img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-icon.svg" width=20px height=20px>
    -   [Accesso al sistema Pi \[senza testa\]](#-logging-into-pi-system-headlessly-)
-   [Installazione di AdGuard](#adguard-install-)<img src="https://www.vectorlogo.zone/logos/adguard/adguard-icon.svg" width=20px height=20px>
    -   [Configura i tuoi dispositivi per funzionare con Adguard](#-set-up-your-devices-to-work-with-adguard-)
    -   [Impostazione della blocklist di AdGuard](#-setting-up-adguard-blocklist-)
        -   [Aggiungi/Rimuovi più URL alla blocklist contemporaneamente](#-addremove-multiple-urls-)
-   [Installazione Unbound](#unbound-install-)<img src="https://www.privacyguides.org/assets/img/legacy_svg/3rd-party/unbound.svg" width=20px height=20px>
-   [Installazione di Cloudflare](#cloudflare-install-)<img src="https://www.vectorlogo.zone/logos/cloudflare/cloudflare-icon.svg" width=20px height=20px>
    -   [Installa Cloudflare (DoH)](#-install-cloudflare-on-pi-with-doh-)
    -   [Configura Cloudflare su Unbound (DoT)](#-configure-cloudflare-on-unbound-with-dot-)
    -   [Configura Stubby (inoltro TLS)](#-configure-stubby-for-unbound-)
    -   [Configura AdGuard con Cloudflare (DoH&DoT)](#-configure-adguard-with-cloudflaredohdot-)
-   [Installazione di WireGuard](#wireguard-install-)<img src="https://www.vectorlogo.zone/logos/wireguard/wireguard-icon.svg" width=20px height=20px>o<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md">OpenVPN (più lento)</a><img src="https://i.imgur.com/Agstbe5.png" width=20px height=20px>
    -   [Connessione alla VPN al telefono Android/IOS](#-connecting-to-the-vpn-to-androidios-phone-)
    -   [Connessione alla VPN da un PC (Windows)](#-connecting-to-the-vpn-from-a-pc-windows-)
    -   [Configura Wireguard con AdGuard/Unbound/Cloudflare](#-configure-wireguard-with-adguardunboundcloudflare-)
        -   [Limita il traffico](#limit-traffic)
        -   [Configurazione IPv6](#ipv6)
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md">Disabilita tutti gli IPv6</a>
-   [Prova VPN](#how-do-you-know-if-wireguard-vpn-is-really-working-)<img src="https://i.imgur.com/6Yf8Zra.png" width=20px height=20px>
-   [Aggiorna automaticamente il tuo Pi](#auto-update-pi-)
-   [Migliorare la durata potenziale della tua scheda SD](#log2ram-install-)
-   [Spegni i LED Pi](#turn-off-pi-led-lights-)
-   [Proteggi il tuo Raspberry Pi](#secure-your-raspberry-pi-)
-   [Risorse del repository](#repository-resources)<img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-books.png" width=20px height=20px>

# 

# Requisiti

-   Una versione Raspberry Pi 3 o 4
-   Un router che supporta il port forwarding (Most Can)
-   Lettore di schede USB MicroSD
-   Scheda MicroSD (8 GB o superiore, almeno Classe 4)
-   cavo Ethernet
-   (Opzionale se si utilizza il monitor) MicroHDMI-(RPi 4) o HDMI-(RPi 3)

    # 

    <p align="center">
      <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 1 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Installing OS Image To SDcard</b></i> </h1>

Questo tutorial è basato sul sistema operativo Raspberry Pi, ma puoi usare qualsiasi Linux<a href="https://github.com/thibmaek/awesome-raspberry-pi#os-images"><b>sistema operativo</b></a>(32 bit o 64 bit) e hardware che preferisci con alcune modifiche_**se sai cosa stai facendo**_! (Raspberry Pi OS è il più semplice e consigliato per Pi o per utenti più esperti,_Sistema operativo DietPi_è anche raccomandato).

Raspberry Pi OS è disponibile nelle versioni Desktop e Lite (usa lite solo per la modalità senza testa). Puoi configurare Raspberry Pi con un monitor/tastiera/mouse o configurarlo "senza testa" da un terminale.

Installa balenEtcher e scarica l'immagine pi per scrivere sulla scheda microSD.

-   Scarica il sistema operativo Raspberry Pi:<https://www.raspberrypi.org/software/operating-systems/>

-   Download balenaEtcher:<https://www.balena.io/etcher/>

Dopo che hai`Etcher`installato e`Raspberry Pi OS`file scaricato sul tuo computer, ora puoi inserire la scheda SD con lettore di schede USB microSD nel tuo computer.

Avvia Etcher e scegli l'immagine del sistema operativo Raspberry Pi che hai scaricato, seleziona la tua scheda microSD e fai clic su "Flash".

<p align="center">
 <img src="https://i.imgur.com/tbB3VIK.jpg">

Al termine del flashing, cerca in "Questo PC" il nome del disco "boot or usb drive" (ricollega il lettore di schede USB se non viene visualizzato). Vai su quel disco, crea un nuovo file di testo chiamato**_`ssh without 'txt' extention`_**. ATTENZIONE, non è "ssh.txt", è "ssh" senza l'estensione. Devi disabilitare l'opzione "Nascondi le estensioni per i tipi di file conosciuti" nelle Opzioni di File Exporer se non le vedi.

<p align="center">
 <img src="https://i.imgur.com/eV6uMbz.jpg">

Ora inserisci la scheda SD nel Raspberry Pi, collega il cavo Ethernet e avvia.

## ╸ Accesso al sistema Pi[Senza testa]╸

-   Ora devi aspettare un minuto per il primo avvio di pi

-   Apri il browser e accedi alla pagina del pannello del tuo router

-   Trova l'elenco di tutti i dispositivi collegati alla tua rete e copia l'indirizzo IP del Raspberry Pi (molto probabilmente avrà il nome host`raspberrypi`)

-   Apri Terminale sul tuo computer host. Puoi usare PowerShell su Windows o RaspController per Android

Digita il seguente comando:

    ssh pi@pi's ip address

È possibile utilizzare il pulsante destro del mouse per incollare il testo in Windows PowerShell.

Digita "yes" per la domanda sull'impronta digitale e digita "raspberry" per una password. Le password saranno invisibili durante la digitazione nell'interfaccia di Linux. Puoi digitare**_`sudo passwd pi`_**per cambiare la password.

<p align="center">
 <img src="https://i.imgur.com/Wf30jxG.jpg">

Esegui nel terminale:

    sudo apt update -y && sudo apt upgrade -y

__ATTENDERE L'AGGIORNAMENTO PER FINIRE e RIAVVIA PI. POI CONTINUARE AL PASSO SUCCESSIVO__.....

    sudo reboot

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 2 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>AdGuard Install</b></i> </h1>

Questo script di installazione proviene da<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>AdGuard Casa</b></a>progetto principale. Segui per restare aggiornato.

Esegui il seguente comando nel tuo terminale:

    curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v

-   Al termine dell'installazione verrà visualizzata una finestra nel terminale che mostra i diversi collegamenti alla tua home page di Adguard (Inizia)

-   `IMPORTANT:`Nell'opzione Ascolta interfacce scegli`Eth0`e seleziona Avanti

<p align="center">
  <img src="https://i.imgur.com/Wa00lDp.jpg" width=580px height=690px>

-   Imposta nome utente e password

-   Ora dovresti essere nel pannello principale di Adguard

-   `IMPORTANT:`Nelle impostazioni generali, imposta "Conservazione registri query" su`24 hours`(Ho letto che per alcune persone i registri si riempiono e rallentano pi e necessitano di un riavvio ogni volta)

## ╸ Configura i tuoi dispositivi per funzionare con Adguard ╸

-   Per Android/Apple, vai alle impostazioni avanzate Wi-Fi e seleziona l'opzione statica. Nel`DNS 1`campo inserire l'indirizzo "ip di pi".

    <p align="center">
     <img src="https://i.imgur.com/nxpiqDw.jpg" width=450px height=580px>

-   Per PC/Finestre

    -   <i>IPV4</i>

        Vai alle impostazioni di rete/modifica le opzioni dell'adattatore e fai clic con il pulsante destro del mouse nelle proprietà, quindi seleziona "Protocollo Internet versione 4 (TCP/IPv4)". Inserisci l'indirizzo IP di pi in`Preferred DNS`server

    -   <i>IPV6 (necessario per`DoH`&`DoT`per lavorare in seguito nella guida se si utilizza ipv6 sul router)</i>

        Vai a "Protocollo Internet versione 6 (TCP/IPv6)" Invio`::1`

`OPTIONAL:`<i>Puoi aggiungere un DNS di backup nei campi alternativi</i>

`BE AWARE:`<i>In Android, l'aggiunta di un DNS pubblico nel secondo campo interrompe il blocco degli annunci di Adguard</i>

<p align="center">
 <img src="https://i.imgur.com/8gsDk3z.jpg">

## ╸ Impostazione della block list di AdGuard ╸

Nella home page di AdGuard, sotto i filtri, seleziona la sezione DNS blocklist per aggiungere gli URL.

<p align="center">
 <img src="https://i.imgur.com/shrtJLD.png">

Puoi cercare su Google diverse blocklist. Ecco la mia abitudine<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/My-Blocklist.txt"><b>lista di Bloccati</b></a>con i miei URL o creane uno tuo da questi<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/%F0%9F%A7%B1Blocklist-Sources%E2%84%B9%EF%B8%8F"><b>fonti</b></a>.

`IMPORTANT:`Alcuni elenchi di blocco possono bloccare alcuni contenuti o siti Web importanti. Per sbloccare vai nella sezione "Registro query" e vedrai_sbloccare_opzione quando il cursore viene posizionato su una query, inserendo i siti Web sbloccati nell'esempio "Regole di filtro personalizzate":`@@||bitly.com^$important`. Cerca l'ip e l'ora del cliente.

<p align="center">
 <img src="https://i.imgur.com/1gZibwD.png">

## ╸ Aggiungi/Rimuovi più URL ╸

Per ora puoi aggiungere solo uno per uno URL nella blocklist DNS in adguard, ma esiste uno script Python per aggiungere più URL insieme.

Apri il nuovo file py (bulkurls.py):

    nano bulkurls.py

Quindi copia e incolla il testo da<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/bulkurls.py"><b>bulkurls.py</b></a>file e salva (Ctrl+x poi y poi invio)**NECESSARIO CONFIGURARE LE CREDENZIALI ADGUARD NEL FILE**.

_Se si utilizza**DietPi**installare`sudo apt-get install python3-pip -y && pip install requests`per la sua non installazione di default._

Correre :`sudo python3 bulkurls.py`

a**rimuovere**devi cambiare`add`in<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/62ba01ed8ed3a5bc5294b9fe7ee38c3e83ae1b86/bulkurls.py#L150"><b>penultima riga</b></a>a`remove`in bulkurls.py file.

Vai a<https://d3ward.github.io/toolz/adblock.html>per verificare se gli annunci stanno bloccando<img src="https://i.imgur.com/Q5oO9EY.png" width=100px height=80px>

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 3 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Unbound Install</b></i> </h1>

Esegui il seguente comando nel tuo terminale:

    sudo apt install unbound -y

Per eseguire query ricorsive su un host che non è memorizzato nella cache come indirizzo, il risolutore deve iniziare dalla parte superiore dell'albero dei server e interrogare i server radice, per sapere dove andare per il dominio di primo livello per l'indirizzo richiesto. Unbound viene fornito con suggerimenti predefiniti predefiniti.

    wget -O root.hints https://www.internic.net/domain/named.root && sudo mv root.hints /var/lib/unbound/

`IMPORTANT:`Questo deve essere aggiornato ogni 6 mesi. a_**Aggiornamento automatico**_root.hints ogni 6 mesi devi creare un cron job.

Entra nella riga di comando`crontab -e`, chiederà Seleziona un editor (scegli 1) e incolla queste righe nella parte inferiore di crontab e salva (control + x poi y quindi invio):

    1 0 1 */6 * wget -O root.hints https://www.internic.net/domain/named.root
    2 0 1 */6 * sudo mv root.hints /var/lib/unbound/

_Se si utilizza**DietPi**è necessario installare resolvconf e riavviare unbound-resolvconf.service per impostare il server dei nomi non associato su 127.0.0.1 :_

    sudo apt-get install resolvconf -y && sudo systemctl restart unbound-resolvconf.service

<p align="center">
 <img src="https://i.imgur.com/26ro62t.jpg">

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 4 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>   

<h1 align="center"><b><i>Cloudflare Install</b></i> </h1>

## ╸ Installa Cloudflare su Pi con`(DoH)`╸

Installa cloudflare con DNS su HTTPS(DoH), segui questi 👉<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Cloudflare-DoH-Setup.md"><b>ISTRUZIONI</b></a>👈.

## ╸ Configura Cloudflare su Unbound con`(DoT)`╸

Crea un file di configurazione non associato inserendo nel prompt dei comandi:

    sudo nano /etc/unbound/unbound.conf.d/unbound.conf

E copia e incolla tutto il testo da<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/unbound.conf"><b>unbound.conf</b></a>file e salva (Ctrl+x poi y poi invio).

## ╸ Configura Stubby per Non vincolato ╸

Usa Unbound per la memorizzazione nella cache e stubby per il forwarder TLS. Installa stubby:

    sudo apt install stubby -y

Rimuovere e ricreare il file stubby.yaml e copiare/incollare tutto il testo da<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/stubby.yml"><b>👉 questa configurazione tozza 👈</b></a>e risparmia. (`cd $h`per tornare alla cartella Inizio al termine).

    cd /etc/stubby/ && sudo rm stubby.yml && sudo nano stubby.yml

-   Riavvia unbound & stubby e controlla lo stato:


    sudo systemctl restart unbound stubby ; systemctl status unbound stubby -l

<p align="center">
 <img src="https://i.imgur.com/7zIpWP2.jpg" width=650px height=370px>

## ╸ Configura Adguard con`Cloudflare(DoH&DoT)`╸

-   Nella home page di AdGuard, sotto le impostazioni, seleziona "Impostazioni DNS"

-   Elimina tutto dalle opzioni del server "Upstream" e "Bootstrap DNS" e:

    -   Per`DNS over TLS(DoT)`Inserisci`127.0.0.1:53`in entrambi i campi del server "Upstream" e "Bootstrap DNS".
    -   Per`DNS over HTTPS(DoH)`Inserisci`127.0.0.1:5053`in entrambi i campi del server "Upstream" e "Bootstrap DNS".
    -   Per`TLS forwarder(stubby)`Inserisci`127.0.0.1:8053`in entrambi i campi del server "Upstream" e "Bootstrap DNS".

-   `IMPORTANT:`Devi controllare"<a href="https://adguard.com/en/blog/in-depth-review-adguard-home.html#dns"><b>Richiesta parallela</b></a>" opzione per il funzionamento simultaneo dei resolver DNS.

<b>Fare clic su Applica e prova a monte</b>(potrebbe ricevere un errore solo nel primo test).

<p align="center">
 <img src="https://i.imgur.com/Ug4Euou.jpg" width=650px height=370px>

-   Quindi nelle impostazioni DNS cerca la sezione di configurazione della cache DNS e imposta la dimensione della cache su`0`(la memorizzazione nella cache è già gestita dall'Unbound) e fare clic su applica.

<p align="center">
 <img src="https://i.imgur.com/8Q5Zb0M.jpg" width=650px height=370px>

### `IMPORTANT:`Il sistema Windows e i browser Android necessitano di alcune modifiche`stabilize`risolutori dns..Linux funziona bene<i>(testato alla menta)</i>

### Windows

-   Installare<a href="https://mayakron.altervista.org/support/acrylic/Home.htm"><b>Proxy DNS acrilico</b></a>

-   Vai a`C:\Program Files (x86)\Acrylic DNS Proxy`e aperto`AcrylicConfiguration.ini`file. Elimina tutto e copia questi<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/AcrylicConfiguration.ini"><b>👉IMPOSTAZIONI👈</b></a>solo cambiare_**Indirizzi del server primario**_all'indirizzo del tuo pi.

-   Nella stessa cartella esegui`RestartAcrylicService.bat`&`PurgeAcrylicCacheData.bat`

    `TIP:`Risoluzione dei problemi relativi ai comandi IP/DNS

        ipconfig /release
        ipconfig /renew
        ipconfig /flushdns

### Androide

-   In qualunque browser utilizzi, gira**spento**`Use Secure DNS`opzione.
-   Tieni presente che possono verificarsi conflitti con rom e kernel personalizzati con root con modifiche dns build.prop o app/modulo Magisk.

#### _Questo è tutto_. Ora vai a<https://1.1.1.1/help>nel browser e dovresti vedere queste opzioni in uscita 'Sì'.

-   [x] Collegato a 1.1.1.1
-   [x] DNS su HTTPS (DoH)
-   [x] DNS su TLS (DoT)
-   [ ] DNS su WARP
    <p align="center">
     <img src="https://i.imgur.com/2S3IH5H.jpg" width=650px height=370px>

#### Altri siti per verificare la sicurezza

<https://browserleaks.com/dns>- dovrebbe mostrare tutto connesso a "Cloudflare"

<https://www.cloudflare.com/ssl/encrypted-sni/>- "Secure DNS / DNSSEC / TLS 1.3" dovrebbe essere tutto un segno di spunta verde

<https://dnssec.vs.uni-due.de/>- dovrebbe dire "Sì, il tuo risolutore DNS convalida le firme DNSSEC"

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 5 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>WireGuard Install</b></i> </h1>

**Prima di installare WireGuard**, se non hai un ip statico devi ottenerne uno gratuito`Dynamic DNS Subdomain`oppure il tuo indirizzo IP esterno molto probabilmente cambia dinamicamente dal tuo ISP ogni tanto e per questo motivo dovrai impostare un servizio DNS dinamico. 👉👉**_▓▒░Usa questo<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>ISTRUZIONI QUI</b></a>░▒▓_**👈👈. Oppure salta il passaggio.

Abbiamo anche bisogno di configurare il port forwarding sul tuo router in modo da poter accedere al wireguard al di fuori della nostra rete come in un hotspot di un bar o ai tuoi dati mobili
TIPO | VALORE  
------------ \| -------------
Dispositivo | Nome host o IP di Raspberry Pi
protocollo | UDP
Intervallo di porte | 51820-51820
Porto in uscita | 51820
Consenti l'accesso a Internet (se disponibile) | sì

Impostazione della porta del mio 👇router👇. Il tuo forse è diverso ma lo capirai. Ricorda che Google 🔍motore di ricerca🔎 è tuo amico. Se non riesci a connetterti da una rete esterna, il che significa che isp ha bloccato le connessioni in uscita, puoi chiamarli e chiedere gentilmente di farlo funzionare.

<p align="center">
 <img src="https://i.imgur.com/9LBEk1i.jpg">

* * *

👊GRANDE GRAZIE👊 per questo script di installazione da<a href="https://github.com/Nyr/wireguard-install"><b>Nyr</b></a>. Segui per restare aggiornato.

Esegui nel terminale

    wget https://git.io/wireguard -O wireguard-install.sh && sudo bash wireguard-install.sh

-   Lo script ti chiederà IPv4/nome host pubblico per la VPN._Se_hai un IP statico, quindi continua oppure digita il dominio DNS dinamico che hai creato da<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>Istruzioni</b></a>. Ad esempio: trinibvpn.freeddns.org

-   Per opzione porta`press enter`per default 51820. Per il nome del client, inserisci il nome che desideri e per il DNS usa l'opzione 3 (`1.1.1.1`) per adesso. configureremo`adguard/unbound/cloudflare`con la VPN al termine dell'installazione

<p align="center">
 <img src="https://i.imgur.com/WUNZIK4.jpg">

-   Attendi fino al termine dell'installazione e alla visualizzazione del codice QR, non chiudere. Ma se lo fai, a`regenerate qrcode`, inserisci nel terminale ma sostituendo solo il nome`yourclientname.conf`file al tuo:


    sudo cp /root/yourclientname.conf /home/pi && sudo qrencode -t ansiutf8 < yourclientname.conf

`IMPORTANT:`Dovrai aggiungere un nuovo utente/client per ogni dispositivo che utilizzi con la VPN. Per aggiungere un nuovo utente, riesegui semplicemente lo script e crea un utente con un nome client diverso.

## Se vuoi usare_Apri VPN_le istruzioni sono<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md"><b>👉qui👈</b></a>

# 

### ╸ Connessione alla VPN al telefono Android/IOS ╸

Installa l'app WireGuard da Google Play o App Store

Wireguard (Google Play):<https://play.google.com/store/apps/details?id=com.wireguard.android>

Wireguard (App Store):<https://apps.apple.com/us/app/wireguard/id1441195209>

È necessario scansionare il codice QR mostrato nel terminale con l'app Wireguard, selezionare il`+ button`e usa l'opzione`Scan from QR code`per installare la configurazione.

`IMPORTANT`: Abilitare**back-end del modulo del kernel**nelle impostazioni

<p align="left">
 <img src="https://i.imgur.com/R4qbiOQ.jpg" width=250px height=350px>

### ╸ Connessione alla VPN da un PC (Windows) ╸

WireGuard per Windows:<https://download.wireguard.com/windows-client/wireguard-installer.exe>

-   Creare un`new text document`con qualsiasi nome sul PC per copiare incollare il testo dal file di configurazione del client wireguard.

-   Per vedere il testo nel file di configurazione del client, digita nel terminale:


    sudo cat /root/yourclientname.conf

-   Evidenzia tutto il testo, copialo e incollalo nel file txt sul pc e salva. Quindi rinomina l'estensione da`txt`a`conf`. Ora hai il file di configurazione per quel client wireguard.

-   Ora puoi importare il file di configurazione su wireguard (opzione importa da file).

## ╸ Configura WireGuard con`Adguard/Unbound/Cloudflare`╸

_Ricorda che questo è per quando sei connesso a WireGuard VPN su una rete esterna o a casa 24 ore su 24, 7 giorni su 7, perché hai già AdGuard/Unbound/Cloudflare configurato e in esecuzione manualmente sui tuoi dispositivi._(nessun problema con entrambi impostati per la mia esperienza).

-   Nell'app Wireguard, seleziona il tuo tunnel e seleziona Modifica (matita in alto a destra)

-   In Server DNS accedi`pi's ip`e salva (IPv4 e IPv6)

<p align="center">
 <img src="https://i.imgur.com/UC0vWfE.jpg" width=450px height=500px>  

### Limita il traffico

Con WireGuard perderai circa il 50% della velocità di Internet causando il processo di tunneling da pi al router ai dispositivi\*\*

Elimina l'opzione "0.0.0.0/0, ::/0" degli IP consentiti perché instrada tutto il traffico alla rete domestica che sarà lenta. Devi inviare traffico solo attraverso i tuoi indirizzi.

-   Per prima cosa devi sostituirlo con il tuo gateway di rete ma impostando l'ultimo numero su zero e<a href="https://www.google.com/search?q=prefix+length+explained&client=firefox-b-d&sxsrf=ALeKk036Jc9vJl73zVXf0yyZs5UlKRlNRQ%3A1621083125589&ei=9cOfYI66I5-qwbkPkdWxkAk&oq=prefix+length+explained&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAcQHjoHCCMQsAMQJzoHCAAQRxCwA1CUJ1iUJ2CiKmgBcAJ4AIABsAGIAdQCkgEDMC4ymAEAoAEBqgEHZ3dzLXdpesgBCcABAQ&sclient=gws-wiz&ved=0ahUKEwjOiOie3cvwAhUfVTABHZFqDJIQ4dUDCA0&uact=5"><b>lunghezza del prefisso</b></a>a 24. Ad esempio:`192.168.1.1/24`a`192.168.1.0/24`o come il mio router ISP`192.168.100.1/24`a`192.168.100.0/24`.~~**Ora perdo solo il 25% di velocità**😁 (ps. utilizzando la rete 5g)~~

`UPDATE:`Dopo un aggiornamento di Wireguard non ottengo una velocità maggiore in questo modo :( .. ma ha comunque senso_non_usare`"0.0.0.0/0, ::/0`con wifi. Se qualcuno conosce qualche ritocco per ottenere una spinta, me lo faccia sapere.

<p align="center">
 <img src="https://i.imgur.com/x4m6Pbl.jpg" width=450px height=500px>

### SI PREGA DI LEGGERE !! , ATTENZIONE!!

`IMPORTANT`:_Se la tua rete ha indirizzi IP per dispositivi che terminano con un numero di 3 cifre (più di 24), ad esempio: 192.168.100.`999`, non sarai in grado di instradare correttamente dalla rete esterna perché l'applicazione di 24 consente solo i numeri da 1 a 24. Devi invece inserire`0`per instradare fuori dall'intervallo 24, ad esempio:`192.168.100.0/0`_.

Oppure puoi cambiare l'intervallo IP sul tuo router (nella mia esperienza potresti ottenere velocità leggermente migliori perché non instrada gli indirizzi IP consentiti non necessari nell'intervallo 24).

<p align="center">
 <img src="https://i.imgur.com/ZZ4aMUI.jpg" width=750px height=550px>

## IPV6

Se stai usando IPv6, quando sei connesso al wifi devi inserire gli IP consentiti da WireGuard`fe80::1/0`anche. Per esempio`192.168.100.0/0, fe80::1/0`

Quando si è collegati a un cavo ethernet su un PC Windows, è necessario accedere`::1`nell'indirizzo IPv6 nel server DNS preferito "Protocollo Internet versione 6(TCP/IPv6)".

Allora vai a<https://ipv6leak.com/>e dovresti vedere "_Il tuo IPv6 non perde_".

# 

<h1 align="left"><a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md"><b>Disable all IPv6</b></a></h2>

# 

## Come fai a sapere se wireguard vpn funziona davvero ??

Per**windows**Scarica<a href="https://www.wireshark.org/#download."><b>Wireshark</b></a>

Una volta scaricato, puoi utilizzare l'applicazione per ispezionare i tuoi pacchetti di dati in cui il protocollo è impostato su quello utilizzato da Wireguard VPN. Quando un traffico a pacchetto è`encrypted`, può essere letto in questo modo ad esempio:

<p align="center">
 <img src="https://i.imgur.com/Tn4M47R.jpg">

Per**androide**Puoi usare<a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture&hl=en&gl=US"><b>PCAPdroide</b></a>. Dovresti vedere tutte le connessioni`closed`e lo stato che mostra tutte le connessioni DNS e non TLS in tutte le app (apri e usa le app per la scansione di PCAPdroid).

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

* * *

# 

<h1 align="center"><b><i>Auto Update Pi</b></i> </h1>

-   Apri il nuovo file sh chiamato update e copia e incolla il testo da<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/update.sh"><b>👉qui👈</b></a>


    sudo nano update.sh

-   Imposta il permesso


    sudo chmod 700 update.sh

-   Apri il file cron inserendo nella riga di comando`crontab -e`, copia incolla la riga di comando del lavoro in basso nella parte inferiore del file cron e salva.


    0 3 * * WED sudo ./update.sh 2>&1 >/home/pi/updatelog

Pi ora si aggiornerà ogni mercoledì alle 3 del mattino. Oppure puoi andare a<https://crontab.guru/>e imposta il tuo programma orario.

Regola la data/il fuso orario di pi immetti nel terminale:

    sudo dpkg-reconfigure tzdata

o impostare manualmente

    sudo date -s "25 DEC 2012 11:14:00"

# 

<h1 align="center"><b><i>Log2Ram Install</b></i> </h1>

Uno dei vantaggi più significativi dell'offload della RAM è che migliora il tuo**Durata potenziale della scheda SD**.
I file di registro sono una delle cose scritte di più dai vari software che installi.
Inserendo i file nella RAM, puoi controllare la frequenza con cui vengono scritti sulla scheda SD. Sarai comunque in grado di accedere a questi file sulla RAM come se si trovassero sulla tua scheda SD.

Copia e incolla questa riga nel terminale:

Manualmente

    wget https://git.io/log2ram -O Log2Ram-Script.sh && sudo chmod +x Log2Ram-Script.sh && sudo ./Log2Ram-Script.sh

o

Aggiungi sorgente repository (aggiornamento automatico)

    echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian/ bullseye main" | sudo tee /etc/apt/sources.list.d/azlux.list
    sudo wget -O /usr/share/keyrings/azlux-archive-keyring.gpg  https://azlux.fr/repo.gpg
    sudo apt update
    sudo apt install log2ram

# 

<h1 align="center"><b><i>Turn Off Pi LED Lights</b></i> </h1>

Immagino che l'alimentazione dei LED influirà sull'elettricità e sul calore non necessari 🤷😅. Non ce n'è bisogno comunque se lo usi solo come server di rete. Apri il file cron inserendo nella riga di comando`crontab -e`, copia incolla la riga di comando del lavoro in basso nella parte inferiore del file cron e salva.

Verde

    @reboot echo none | sudo tee /sys/class/leds/led0/trigger

rosso

    @reboot echo none | sudo tee /sys/class/leds/led1/trigger

Riavvia pi.

# 

<h1 align="center"><b><i>Secure Your Raspberry Pi</b></i> </h1>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><img src="https://i.imgur.com/a9JQVls.png" width=80px height=90px></a>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><b>LINK</b></a>

<i>(Uso solo Fail2Ban e cambio la porta SSH)</i>

**[⬆ TORNA ALL'INIZIO ⬆](#contents)**

* * *

<p align="center">
<b>🎉🎉 THAT'S IT !! 🎉🎉 YOUR FINISH 👌👌
<p align="center">
<b>ANY ISSUES, FIXES OR TIPS TO MAKE THESE PROJECTS BETTER PLEASE CONTRIBUTE🤖</b>

* * *

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"
<br> 
<br> 
<br> 

<p align="center">
 <img src="https://i.imgur.com/Q07E7SW.gif" width=500px height=30px>

<p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/stargazers"><img src="https://reporoster.com/stars/dark/trinib/AdGuard-WireGuard-Unbound-Cloudflare"></a>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" </p>

# 

## _Risorse del repository_

<h5 https://www.raspberrypi.com/documentation/

<https://github.com/AdguardTeam/AdGuardHome/wiki/Getting-Started>

<https://developers.cloudflare.com/>

<https://docs.pi-hole.net/guides/dns/cloudflared/>

<https://docs.pi-hole.net/guides/dns/unbound/>

<https://nlnetlabs.nl/documentation/unbound/unbound.conf/>

<https://dnsprivacy.org/dns_privacy_clients/>

<https://github.com/anudeepND/pihole-unbound>

<https://github.com/stong/unbound.conf.d>

<https://github.com/Nyr/wireguard-install>

<https://github.com/azlux/log2ram>

* * *

<h4

Domande frequenti:<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions/17"><b>LINK</b></a>
