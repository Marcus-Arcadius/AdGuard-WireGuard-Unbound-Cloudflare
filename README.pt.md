# ![logo](https://i.imgur.com/zqJELkl.png)

<p align="center">
 <img src="https://img.shields.io/badge/License-MIT-blue.svg">
 <img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103">
 <img src="http://ForTheBadge.com/images/badges/built-with-love.svg">
 <img src="https://img.shields.io/badge/badges-awesome-green.svg">
 <img src="https://img.shields.io/badge/Stay-Safe-red?logo=data:image/svg%2bxml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEwIDUxMCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTAgNTEwIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im0xNzQuNjEgMzAwYy0yMC41OCAwLTQwLjU2IDYuOTUtNTYuNjkgMTkuNzJsLTExMC4wOSA4NS43OTd2MTA0LjQ4M2g1My41MjlsNzYuNDcxLTY1aDEyNi44MnYtMTQ1eiIgZmlsbD0iI2ZmZGRjZSIvPjwvZz48cGF0aCBkPSJtNTAyLjE3IDI4NC43MmMwIDguOTUtMy42IDE3Ljg5LTEwLjc4IDI0LjQ2bC0xNDguNTYgMTM1LjgyaC03OC4xOHYtODVoNjguMThsMTE0LjM0LTEwMC4yMWMxMi44Mi0xMS4yMyAzMi4wNi0xMC45MiA0NC41LjczIDcgNi41NSAxMC41IDE1LjM4IDEwLjUgMjQuMnoiIGZpbGw9IiNmZmNjYmQiLz48cGF0aCBkPSJtMzMyLjgzIDM0OS42M3YxMC4zN2gtNjguMTh2LTYwaDE4LjU1YzI3LjQxIDAgNDkuNjMgMjIuMjIgNDkuNjMgNDkuNjN6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTM5OS44IDc3LjN2OC4wMWMwIDIwLjY1LTguMDQgNDAuMDctMjIuNjQgNTQuNjdsLTExMi41MSAxMTIuNTF2LTIyNi42NmwzLjE4LTMuMTljMTQuNi0xNC42IDM0LjAyLTIyLjY0IDU0LjY3LTIyLjY0IDQyLjYyIDAgNzcuMyAzNC42OCA3Ny4zIDc3LjN6IiBmaWxsPSIjZDAwMDUwIi8+PHBhdGggZD0ibTI2NC42NSAyNS44M3YyMjYuNjZsLTExMi41MS0xMTIuNTFjLTE0LjYtMTQuNi0yMi42NC0zNC4wMi0yMi42NC01NC42N3YtOC4wMWMwLTQyLjYyIDM0LjY4LTc3LjMgNzcuMy03Ny4zIDIwLjY1IDAgNDAuMDYgOC4wNCA1NC42NiAyMi42NHoiIGZpbGw9IiNmZjRhNGEiLz48cGF0aCBkPSJtMjEyLjgzIDM2MC4xMnYzMGg1MS44MnYtMzB6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTI2NC42NSAzNjAuMTJ2MzBoMzYuMTRsMzIuMDQtMzB6IiBmaWxsPSIjZmZiZGE5Ii8+PC9nPjwvc3ZnPg==">

</p>
 <p align="center">
     <a href="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge" alt="GitHub Repo stars">
         <img src="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge" alt="GitHub forks">
         <img src="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge" alt="GitHub watchers">
         <img src="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge"></a>
</p>

<p align="center">
 <img src="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/assets/images/awcu.gif" width= "700">

#### _<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>AdGuard</b></a>_: Adblocker para seus dispositivos em casa (<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md#how-does-adguard-home-compare-to-pi-hole"><b>_AdGuard comparado ao Pi-Hole_</b></a>)

#### _<a href="https://www.wireguard.com/"><b>WireGuard</b></a>_: Um servidor VPN em casa acessível a partir de qualquer rede externa (IPv4 e IPv6)

#### _<a href="https://www.nlnetlabs.nl/projects/unbound/about/"><b>Não vinculado</b></a>com &lt;a href="<https://dnsprivacy.org/dns_privacy_daemon>_-_atarracado/sobre_atarracado/"><b>Atarracado</b></a>_: Um resolvedor de DNS de validação, recursivo e de cache

#### _<a href="https://www.cloudflare.com/learning/what-is-cloudflare/"><b>Cloudflare</b></a>_: Melhor desempenho e segurança ao navegar em sites (DoT e DoH)

* * *

# 

<h2 align="left">🧪 Speed results with <a href="https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/testingdnsusingdig.htm"><b>BIND's DNS Tool </b></a> 🧪</h1>

<b>Tempo de consulta (google.com) em milissegundos:</b>

-   Resolvedores de DNS padrão do Adguard -`60-70 msec`
-   Resolvedores de DNS públicos da Cloudflare/Quad9/Google -`50-70 msec`
-   Esta instalação/configuração -`5-10 msec`

<details><summary><b>🎥Video Previews🎥<img src="https://media.giphy.com/media/WT5h7PgVSScLLKtMaS/giphy.gif" width=50px height=40px></b></summary>
<p>

### 【Adguard DNS padrão】<i>VS</i>⭐esta configuração⭐ :

<https://user-images.githubusercontent.com/18756975/150230438-b767e86f-4e18-4791-b5fe-0813615a37a3.mp4>

### Resolvedores de DNS públicos【cloudflare/quad9/google】:

<https://user-images.githubusercontent.com/18756975/150319049-3d8acdc9-624f-4b60-8ee2-b80227522252.mp4>

</p>
 </details>

* * *

<h4><p align="center">
⏰Last Checked : 25 Feb 2022⏰</h2>

<div align="center">

|                             Projetos                             |                           Status                           |
| :--------------------------------------------------------------: | :--------------------------------------------------------: |
|                     Página inicial do AdGuard                    |                              ✅                             |
|                           Não vinculado                          |                              ✅                             |
|                            Cloudflare                            |                              ✅                             |
|                            Atarracado                            |                              ✅                             |
|                             WireGuard                            |                              ✅                             |

</div>
<div>

# 

# Conteúdo

-   <a href="https://git.io/About">Sobre</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/parrots/party-nyan.gif" width=20px height=20px>
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions">Discussões/F.A.Q</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-speech-balloon.png" width=20px height=20px>
-   [Requisitos](#requirements)
-   [Instalando o sistema operacional Pi](#installing-os-image-to-sdcard-)<img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-icon.svg" width=20px height=20px>
    -   [Fazendo login no sistema Pi \[sem cabeça\]](#-logging-into-pi-system-headlessly-)
-   [Instalando o AdGuard](#adguard-install-)<img src="https://www.vectorlogo.zone/logos/adguard/adguard-icon.svg" width=20px height=20px>
    -   [Configure seus dispositivos para trabalhar com o Adguard](#-set-up-your-devices-to-work-with-adguard-)
    -   [Configurando a lista de bloqueio do AdGuard](#-setting-up-adguard-blocklist-)
        -   [Adicionar/remover vários URLs à lista de bloqueio de uma só vez](#-addremove-multiple-urls-)
-   [Instalando Unbound](#unbound-install-)<img src="https://www.privacytools.io/img/apps/unbound.svg" width=20px height=20px>
-   [Instalando o Cloudflare](#cloudflare-install-)<img src="https://www.vectorlogo.zone/logos/cloudflare/cloudflare-icon.svg" width=20px height=20px>
    -   [Instale o Cloudflare (DoH)](#-install-cloudflare-on-pi-with-doh-)
    -   [Configurar Cloudflare em Unbound (DoT)](#-configure-cloudflare-on-unbound-with-dot-)
    -   [Configurar Stubby (Encaminhador TLS)](#-configure-stubby-for-unbound-)
    -   [Configurar AdGuard com Cloudflare (DoH&DoT)](#-configure-adguard-with-cloudflaredohdot-)
-   [Instalando o WireGuard](#wireguard-install-)<img src="https://www.vectorlogo.zone/logos/wireguard/wireguard-icon.svg" width=20px height=20px>ou<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md">OpenVPN (mais lento)</a><img src="https://i.imgur.com/Agstbe5.png" width=20px height=20px>
    -   [Conectando-se à VPN ao telefone Android/IOS](#-connecting-to-the-vpn-to-androidios-phone-)
    -   [Conectando-se à VPN a partir de um PC (Windows)](#-connecting-to-the-vpn-from-a-pc-windows-)
    -   [Configurar Wireguard com AdGuard/Unbound/Cloudflare](#-configure-wireguard-with-adguardunboundcloudflare-)
        -   [Limitar o tráfego](#limit-traffic)
        -   [Configuração IPv6](#ipv6)
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md">Desabilitar todos os IPv6</a>
-   [Teste de VPN](#how-do-you-know-if-wireguard-vpn-is-really-working-)<img src="https://i.imgur.com/6Yf8Zra.png" width=20px height=20px>
-   [Atualize automaticamente seu Pi](#auto-update-pi-)
-   [Melhorando a vida útil potencial do seu cartão SD](#log2ram-install-)
-   [Desligue os LEDs Pi](#turn-off-pi-led-lights-)
-   [Protegendo seu Raspberry Pi](#secure-your-raspberry-pi-)
-   [Recursos do Repositório](#repository-resources)<img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-books.png" width=20px height=20px>

# 

# Requisitos

-   Uma versão Raspberry Pi 3 ou 4
-   Um roteador que suporta o encaminhamento de porta (Most Can)
-   Leitor de cartão microSD USB
-   Cartão MicroSD (8 GB ou maior, pelo menos Classe 4)
-   Cabo Ethernet
-   (Opcional se estiver usando monitor) MicroHDMI-(RPi 4) ou HDMI-(RPi 3)

    # 

    <p align="center">
      <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 1 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Installing OS Image To SDcard</b></i> </h1>

Este tutorial é baseado no Raspberry Pi OS, mas você pode usar qualquer linux<a href="https://github.com/thibmaek/awesome-raspberry-pi#os-images"><b>sistema operacional</b></a>(32 bits ou 64 bits) e hardware de sua preferência com alguns ajustes_**se você sabe o que está fazendo**_! (Raspberry Pi OS é mais simples e recomendado para Pi ou para usuários mais experientes,_DietPi OS_também é recomendado).

O Raspberry Pi OS vem nas versões Desktop e Lite (use lite apenas para o modo headless). Você pode configurar o Raspberry Pi com um monitor/teclado/mouse ou configurá-lo “sem cabeça” a partir de um terminal.

Instale o balenEtcher e baixe a imagem pi para escrever no cartão microSD.

-   Download Raspberry Pi OS:<https://www.raspberrypi.org/software/operating-systems/>

-   Baixar baleiaEtcher:<https://www.balena.io/etcher/>

Depois que você tiver`Etcher`instalado e`Raspberry Pi OS`arquivo baixado em seu computador, agora você pode inserir o cartão SD com leitor de cartão microSD USB em seu computador.

Inicie o Etcher e escolha a imagem do Raspberry Pi OS que você baixou, selecione seu cartão microSD e clique em “Flash”.

<p align="center">
 <img src="https://i.imgur.com/tbB3VIK.jpg">

Depois que o flash for concluído, procure em "Este PC" por um nome de disco "boot or usb drive" (reconecte o leitor de cartão usb se não for visto). Vá para esse disco, crie um novo arquivo de texto chamado**_`ssh without 'txt' extention`_**. CUIDADO, não é “ssh.txt”, é “ssh” sem a extensão. Você precisa desabilitar a opção “Ocultar extensões para tipos de arquivos conhecidos” nas Opções do Explorador de Arquivos se não as vir.

<p align="center">
 <img src="https://i.imgur.com/eV6uMbz.jpg">

Agora coloque o cartão SD no Raspberry Pi, conecte o cabo Ethernet e inicialize.

## ╸ Entrando no sistema Pi[Sem cabeça]╸

-   Agora você precisa esperar um minuto para a primeira inicialização do pi

-   Abra o navegador e faça login na página do painel do seu roteador

-   Encontre a lista de todos os dispositivos conectados à sua rede e copie o endereço IP do Raspberry Pi (provavelmente terá o nome do host`raspberrypi`)

-   Abra o Terminal em sua máquina host. Você pode usar o PowerShell no Windows ou RaspController para Android

Digite o seguinte comando:

    ssh pi@pi's ip address

Você pode usar o botão direito do mouse para colar texto no Windows PowerShell.

Digite "yes" para a pergunta de impressão digital e digite "raspberry" para uma senha. As senhas serão invisíveis ao digitar na interface linux. Você pode digitar**_`sudo passwd pi`_**para alterar a senha.

<p align="center">
 <img src="https://i.imgur.com/Wf30jxG.jpg">

Execute no terminal:

    sudo apt update -y && sudo apt upgrade -y

__AGUARDE ATUALIZAÇÃO PARA TERMINAR e REINICIAR PI. ENTÃO CONTINUE PARA O PRÓXIMO PASSO__.....

    sudo reboot

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 2 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>AdGuard Install</b></i> </h1>

Este script de instalação é de<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>Página inicial do AdGuard</b></a>projeto principal. Siga para se manter atualizado.

Execute o seguinte comando no seu terminal:

    curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v

-   Quando a instalação estiver concluída, uma janela aparecerá no terminal mostrando os diferentes links para a página inicial do SEU Adguard (Começar)

-   `IMPORTANT:`Na opção Ouvir Interfaces escolha`Eth0`e selecione próximo

<p align="center">
  <img src="https://i.imgur.com/Wa00lDp.jpg" width=580px height=690px>

-   Configurar nome de usuário e senha

-   Agora você deve estar no painel inicial do Adguard

-   `IMPORTANT:`Nas configurações gerais, defina "Retenção de logs de consulta" como`24 hours`(Eu li que, para algumas pessoas, os logs enchem e diminuem a velocidade do pi e precisam ser reiniciados sempre)

## ╸ Configure seus dispositivos para trabalhar com o Adguard ╸

-   Para Android/Apple, vá para configurações avançadas de wifi e selecione a opção estática. Dentro`DNS 1`campo digite o endereço "ip do pi"

    <p align="center">
     <img src="https://i.imgur.com/nxpiqDw.jpg" width=450px height=580px>

-   Para PC/Windows

    -   <i>IPV4</i>

        Vá para configurações de rede / altere as opções do adaptador e clique com o botão direito do mouse em propriedades e selecione "Internet Protocol Version 4(TCP/IPv4)". Digite o endereço IP do pi em`Preferred DNS`servidor

    -   <i>IPV6 (necessário para`DoH`&`DoT`para trabalhar mais tarde no guia se estiver usando ipv6 no seu roteador)</i>

        Vá para "Protocolo de Internet Versão 6 (TCP/IPv6)" Digite`::1`

`OPTIONAL:`<i>Você pode adicionar um DNS de backup nos campos alternativos</i>

`BE AWARE:`<i>No Android, adicionar um DNS público no segundo campo quebra o bloqueio de anúncios do Adguard</i>

<p align="center">
 <img src="https://i.imgur.com/8gsDk3z.jpg">

## ╸ Configurando a lista de bloqueio do AdGuard ╸

Na página inicial do AdGuard, em filtros, selecione a seção de lista de bloqueio DNS para adicionar URLs.

<p align="center">
 <img src="https://i.imgur.com/shrtJLD.png">

Você pode pesquisar no Google por uma lista de bloqueio diferente.Aqui está minha customização<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/My-Blocklist.txt"><b>lista de bloqueio</b></a>com meus urls ou crie o seu próprio a partir destes<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/%F0%9F%A7%B1Blocklist-Sources%E2%84%B9%EF%B8%8F"><b>origens</b></a>.

`IMPORTANT:`Algumas listas de bloqueio podem bloquear alguns conteúdos ou sites importantes. Para desbloquear vá na seção "Query Log" e verá_desbloquear_opção quando o cursor passa sobre uma consulta, colocando sites desbloqueados no exemplo de "Regras de filtragem personalizadas":`@@||bitly.com^$important`. Procure o ip e horário do cliente.

<p align="center">
 <img src="https://i.imgur.com/1gZibwD.png">

## ╸ Adicionar/Remover vários URLs ╸

Você só pode adicionar um por um URL na lista de bloqueio dns no adguard por enquanto, mas há um script python para adicionar vários URLs juntos.

Abra um novo arquivo py (bulkurls.py):

    nano bulkurls.py

Em seguida, copie e cole o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/bulkurls.py"><b>bulkurls.py</b></a>arquivo e salve (control+x então y então enter)**PRECISA CONFIGURAR SUAS CREDENCIAIS DE ADGUARD NO ARQUIVO**.

_Se estiver usando**DietPi**instalar`sudo apt-get install python3-pip -y && pip install requests`por não instalar por padrão._

Para correr :`sudo python3 bulkurls.py`

Para**remover**você precisa mudar`add`dentro<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/62ba01ed8ed3a5bc5294b9fe7ee38c3e83ae1b86/bulkurls.py#L150"><b>segundo da última linha</b></a>para`remove`no arquivo bulkurls.py.

Vamos para<https://d3ward.github.io/toolz/adblock.html>para testar se os anúncios estão bloqueando<img src="https://i.imgur.com/Q5oO9EY.png" width=100px height=80px>

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 3 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Unbound Install</b></i> </h1>

Execute o seguinte comando no seu terminal:

    sudo apt install unbound -y

Para consultar recursivamente um host que não está armazenado em cache como um endereço, o resolvedor precisa iniciar no topo da árvore do servidor e consultar os servidores raiz, para saber onde ir para o domínio de nível superior do endereço que está sendo consultado. Unbound vem com dicas internas padrão.

    wget -O root.hints https://www.internic.net/domain/named.root && sudo mv root.hints /var/lib/unbound/

`IMPORTANT:`Isso precisa ser atualizado a cada 6 meses. Para_**atualização automática**_root.hints a cada 6 meses você precisa criar um cron job.

Entre na linha de comando`crontab -e`, ele perguntará Selecione um editor (escolha 1) e cole essas linhas na parte inferior do crontab e salve (control+x então y e digite):

    1 0 1 */6 * wget -O root.hints https://www.internic.net/domain/named.root
    2 0 1 */6 * sudo mv root.hints /var/lib/unbound/

_Se estiver usando**DietPi**você precisa instalar o resolvconf e reiniciar o unbound-resolvconf.service para definir o servidor de nomes não vinculado como 127.0.0.1 :_

    sudo apt-get install resolvconf -y && sudo systemctl restart unbound-resolvconf.service

<p align="center">
 <img src="https://i.imgur.com/26ro62t.jpg">

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 4 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>   

<h1 align="center"><b><i>Cloudflare Install</b></i> </h1>

## ╸ Instale o Cloudflare no Pi com`(DoH)`╸

Instale o cloudflare com DNS sobre HTTPS (DoH), siga estes 👉<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Cloudflare-DoH-Setup.md"><b>INSTRUÇÕES</b></a>👈.

## ╸ Configurar Cloudflare em Unbound With`(DoT)`╸

Crie um arquivo de configuração não vinculado digitando no prompt de comando:

    sudo nano /etc/unbound/unbound.conf.d/unbound.conf

E copie e cole todo o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/unbound.conf"><b>unbound.conf</b></a>arquivo e salve (control+x então y então enter).

## ╸ Configurar Stubby para Unbound ╸

Use Unbound para armazenamento em cache e stubby para encaminhador TLS. Instale atarracado:

    sudo apt install stubby -y

Remova e recrie o arquivo stubby.yaml e copie/cole todo o texto de<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/stubby.yml"><b>👉 esta configuração atarracada 👈</b></a>e salve. (`cd $h`para retornar à pasta inicial quando terminar).

    cd /etc/stubby/ && sudo rm stubby.yml && sudo nano stubby.yml

-   Reinicie o unbound & stubby e verifique o status:


    sudo systemctl restart unbound stubby ; systemctl status unbound stubby -l

<p align="center">
 <img src="https://i.imgur.com/7zIpWP2.jpg" width=650px height=370px>

## ╸ Configurar Adguard com`Cloudflare(DoH&DoT)`╸

-   Na página inicial do AdGuard, em configurações, selecione "Configurações de DNS"

-   Exclua tudo das opções de servidor "Upstream" e "Bootstrap DNS" e:

    -   Por`DNS over TLS(DoT)`adicionar`127.0.0.1:53`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`DNS over HTTPS(DoH)`adicionar`127.0.0.1:5053`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`TLS forwarder(stubby)`adicionar`127.0.0.1:8053`nos campos de servidor "Upstream" e "Bootstrap DNS"

-   `IMPORTANT:`Você precisa verificar "<a href="https://adguard.com/en/blog/in-depth-review-adguard-home.html#dns"><b>Solicitação paralela</b></a>" opção para os resolvedores de dns funcionarem simultaneamente.

<b>Clique em aplicar e teste upstreams</b>(pode obter um erro apenas no primeiro teste).

<p align="center">
 <img src="https://i.imgur.com/Ug4Euou.jpg" width=650px height=370px>

-   Em seguida, na configuração de DNS, procure a seção de configuração de cache DNS e defina o tamanho do cache para`0`(o armazenamento em cache já é tratado pelo Unbound) e clique em aplicar.

<p align="center">
 <img src="https://i.imgur.com/8Q5Zb0M.jpg" width=650px height=370px>

### `IMPORTANT:`O sistema Windows e os navegadores Android precisam de alguns ajustes para`stabilize`resolvedores de DNS..Linux funciona bem<i>(testado em hortelã)</i>

### janelas

-   Instalar<a href="https://mayakron.altervista.org/support/acrylic/Home.htm"><b>Proxy DNS acrílico</b></a>

-   Vamos para`C:\Program Files (x86)\Acrylic DNS Proxy`e abra`AcrylicConfiguration.ini`Arquivo. Apague tudo e copie estes<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/AcrylicConfiguration.ini"><b>👉CONFIGURAÇÕES👈</b></a>só mudar_**EndereçosServidorPrimário**_para o endereço do seu pi.

-   Na mesma pasta execute`RestartAcrylicService.bat`&`PurgeAcrylicCacheData.bat`

    `TIP:`Solucionar problemas de comandos IP/DNS

        ipconfig /release
        ipconfig /renew
        ipconfig /flushdns

### Android

-   Em qualquer navegador que você usa, ligue**fora**`Use Secure DNS`opção.
-   Esteja ciente de que os conflitos podem ocorrer com roms e kernels com root personalizados com ajustes de dns do build.prop ou aplicativos/módulo Magisk.

#### _É isso_. Agora vá para<https://1.1.1.1/help>no navegador e você deve ver essas opções como saída 'Sim'.

-   [x] Conectado a 1.1.1.1
-   [x] DNS sobre HTTPS (DoH)
-   [x] DNS sobre TLS (DoT)
-   [ ] DNS sobre WARP
    <p align="center">
     <img src="https://i.imgur.com/2S3IH5H.jpg" width=650px height=370px>

#### Outros sites para verificar a segurança

<https://browserleaks.com/dns>- deve mostrar todos conectados ao "Cloudflare"

<https://www.cloudflare.com/ssl/encrypted-sni/>- "Secure DNS / DNSSEC / TLS 1.3" deve estar com um visto verde

<https://dnssec.vs.uni-due.de/>- deve dizer "Sim, seu resolvedor de DNS valida assinaturas DNSSEC"

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 5 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>WireGuard Install</b></i> </h1>

**Antes de instalar o WireGuard**, se você não tiver um ip estático, você precisa obter um`Dynamic DNS Subdomain`ou então seu endereço IP externo provavelmente muda dinamicamente de seu ISP com muita frequência e, por esse motivo, você precisará configurar um serviço DNS dinâmico. 👉👉**_▓▒░Use este<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>INSTRUÇÕES AQUI</b></a>░▒▓_**👈👈. Ou então pule a etapa.

Também precisamos configurar o encaminhamento de porta em seu roteador para que possamos acessar o wireguard fora de nossa rede, como em um hotspot de café ou seus dados móveis
TIPO | VALOR  
------------ \| -------------
Dispositivo | Nome de host ou IP do Raspberry Pi
Protocolo | UDP
Faixa de portas | 51820-51820
Porto de saída | 51820
Permitir acesso à Internet (se tiver) | sim

Configuração da porta do meu 👇roteador👇. O seu pode ser diferente, mas você vai conseguir. Lembre-se de que o 🔍mecanismo de pesquisa🔎 do Google é seu amigo. Se você não puder se conectar de uma rede externa, o que significa que o isp bloqueou as conexões de saída, você pode ligar para eles e pedir gentilmente para fazê-lo funcionar.

<p align="center">
 <img src="https://i.imgur.com/9LBEk1i.jpg">

* * *

👊MUITO OBRIGADO👊 por este script de instalação de<a href="https://github.com/Nyr/wireguard-install"><b>Nova</b></a>. Siga para se manter atualizado.

Executar no terminal

    wget https://git.io/wireguard -O wireguard-install.sh && sudo bash wireguard-install.sh

-   O script solicitará IPv4/nome de host público para a VPN._Se_você tem ip estático, então continue ou digite o domínio DNS dinâmico que você criou a partir do<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>instruções</b></a>. Por exemplo: trinibvpn.freeddns.org

-   Para opção de porta`press enter`para o padrão 51820. Para o nome do cliente, basta colocar o nome que quiser, e para o DNS use a opção 3 (`1.1.1.1`) por enquanto. Nós vamos configurar`adguard/unbound/cloudflare`com o vpn depois de instalado

<p align="center">
 <img src="https://i.imgur.com/WUNZIK4.jpg">

-   Aguarde até que a instalação termine e o código QR apareça, não feche. Mas se você fizer isso, para`regenerate qrcode`, digite no terminal, mas substituindo apenas o nome`yourclientname.conf`arquivo para o seu:


    sudo cp /root/yourclientname.conf /home/pi && sudo qrencode -t ansiutf8 < yourclientname.conf

`IMPORTANT:`Você precisará adicionar um novo usuário/cliente para cada dispositivo usado com a VPN. Para adicionar um novo usuário, basta executar novamente o script e criar um usuário com um nome de cliente diferente.

## Se você quiser usar_OpenVPN_as instruções são<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md"><b>👉aqui👈</b></a>

# 

### ╸ Conectando-se à VPN ao telefone Android/IOS ╸

Instale o aplicativo WireGuard do Google Play ou App Store

Proteção de fio (Google Play):<https://play.google.com/store/apps/details?id=com.wireguard.android>

Wireguard (App Store):<https://apps.apple.com/us/app/wireguard/id1441195209>

Você precisa digitalizar o código QR mostrado no terminal com o aplicativo Wireguard, selecione o`+ button`e use a opção`Scan from QR code`para instalar a configuração.

`IMPORTANT`: Habilitar**back-end do módulo do kernel**nas configurações

<p align="left">
 <img src="https://i.imgur.com/R4qbiOQ.jpg" width=250px height=350px>

### ╸ Conectando-se à VPN de um PC (Windows) ╸

WireGuard para janelas:<https://download.wireguard.com/windows-client/wireguard-installer.exe>

-   Criar uma`new text document`com qualquer nome no pc para copiar e colar o texto do arquivo de configuração do cliente wireguard.

-   Para ver o texto no arquivo de configuração do cliente, digite terminal:


    sudo cat /root/yourclientname.conf

-   Realce todo o texto, copie e cole no arquivo txt no pc e salve. Em seguida, renomeie a extensão de`txt`para`conf`. Agora você tem o arquivo de configuração para esse cliente wireguard.

-   Agora você pode importar o arquivo de configuração para o wireguard (opção importar do arquivo).

## ╸ Configure o WireGuard com`Adguard/Unbound/Cloudflare`╸

_Lembre-se que isso é para quando você estiver conectado ao WireGuard VPN em uma rede externa ou em casa 24 horas por dia, 7 dias por semana, porque você já tem o AdGuard/Unbound/Cloudflare configurado e em execução em seus dispositivos manualmente._(não há problema em ter ambos configurados para minha experiência).

-   No aplicativo wireguard, selecione seu túnel e selecione editar (lápis no canto superior direito)

-   Em servidores DNS, insira`pi's ip`e salve (IPv4 e IPv6)

<p align="center">
 <img src="https://i.imgur.com/UC0vWfE.jpg" width=450px height=500px>  

### Limitar o tráfego

Com o WireGuard, você perderá cerca de 50% da velocidade da internet, pois o processo de encapsulamento do pi para o roteador para os dispositivos\*\*

Excluir nos IPs permitidos a opção "0.0.0.0/0, ::/0" porque ela roteia todo o tráfego para sua rede doméstica, o que será lento. Você precisa enviar tráfego apenas através de seus endereços.

-   Primeiro você precisa substituí-lo pelo seu gateway de rede, mas definindo o último número como zero e<a href="https://www.google.com/search?q=prefix+length+explained&client=firefox-b-d&sxsrf=ALeKk036Jc9vJl73zVXf0yyZs5UlKRlNRQ%3A1621083125589&ei=9cOfYI66I5-qwbkPkdWxkAk&oq=prefix+length+explained&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAcQHjoHCCMQsAMQJzoHCAAQRxCwA1CUJ1iUJ2CiKmgBcAJ4AIABsAGIAdQCkgEDMC4ymAEAoAEBqgEHZ3dzLXdpesgBCcABAQ&sclient=gws-wiz&ved=0ahUKEwjOiOie3cvwAhUfVTABHZFqDJIQ4dUDCA0&uact=5"><b>comprimento do prefixo</b></a>a 24. Por exemplo:`192.168.1.1/24`para`192.168.1.0/24`ou como meu roteador ISP`192.168.100.1/24`para`192.168.100.0/24`.~~**Agora eu só perco 25% de velocidade**😁 (ps. usando rede 5g)~~

`UPDATE:`Após uma atualização do Wireguard, não consigo uma velocidade mais rápida fazendo isso :( .. mas ainda faz sentido_não_usar`"0.0.0.0/0, ::/0`com wi-fi. Se alguém souber de algum ajuste para obter um impulso, me avise.

<p align="center">
 <img src="https://i.imgur.com/x4m6Pbl.jpg" width=450px height=500px>

### POR FAVOR LEIA !! , ESTAR CIENTE !!

`IMPORTANT`:_Se sua rede possui endereços IP para dispositivos que terminam com um número de 3 dígitos (mais de 24), por exemplo: 192.168.100.`999`, você não poderá rotear corretamente a partir da rede externa porque a aplicação de 24 permite apenas os números de 1 a 24. Em vez disso, você precisa colocar`0`para rotear fora do intervalo 24, por exemplo:`192.168.100.0/0`_.

Ou você pode alterar o intervalo de ip no seu roteador (na minha experiência, você pode obter velocidades um pouco melhores porque ele não roteará endereços ip permitidos desnecessários no intervalo 24).

<p align="center">
 <img src="https://i.imgur.com/ZZ4aMUI.jpg" width=750px height=550px>

## IPV6

Se você estiver usando IPv6, quando estiver conectado ao wifi, precisará inserir os IPs permitidos do WireGuard`fe80::1/0`também. Por exemplo`192.168.100.0/0, fe80::1/0`

Quando conectado ao cabo ethernet em um PC com Windows, você precisa inserir`::1`no endereço IPv6 no servidor DNS preferencial "Internet Protocol Version 6(TCP/IPv6)".

Então vá para<https://ipv6leak.com/>e você deve ver "_Seu IPv6 não está vazando_".

# 

<h1 align="left"><a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md"><b>Disable all IPv6</b></a></h2>

# 

## Como você sabe se a VPN wireguard está realmente funcionando?

Por**janelas**download<a href="https://www.wireshark.org/#download."><b>Wireshark</b></a>

Uma vez baixado, você pode usar o aplicativo para inspecionar seus pacotes de dados onde o protocolo está definido para o usado pelo Wireguard VPN. Quando um tráfego de pacotes é`encrypted`, pode ser lido assim, por exemplo:

<p align="center">
 <img src="https://i.imgur.com/Tn4M47R.jpg">

Por**andróide**você pode usar<a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture&hl=en&gl=US"><b>PCAPdroid</b></a>. Você deve ver todas as conexões`closed`e status mostrando todas as conexões DNS e não todas as conexões TLS em todos os aplicativos (abra e use aplicativos para PCAPdroid para verificar).

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

* * *

# 

<h1 align="center"><b><i>Auto Update Pi</b></i> </h1>

-   Abra um novo arquivo sh chamado update e copie e cole o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/update.sh"><b>👉aqui👈</b></a>


    sudo nano update.sh

-   Definir permissão


    sudo chmod 700 update.sh

-   Abra o arquivo cron digitando na linha de comando`crontab -e`, copie e cole a linha de comando do trabalho abaixo na parte inferior do arquivo cron e salve.


    0 3 * * WED sudo ./update.sh 2>&1 >/home/pi/updatelog

O Pi agora será atualizado todas as quartas-feiras às 3h. Ou você pode ir para<https://crontab.guru/>e defina o seu próprio horário.

Ajuste a data/fuso horário do pi no terminal:

    sudo dpkg-reconfigure tzdata

ou definir manualmente

    sudo date -s "25 DEC 2012 11:14:00"

# 

<h1 align="center"><b><i>Log2Ram Install</b></i> </h1>

Uma das vantagens mais significativas de descarregar sua memória RAM é que melhora sua**Vida útil potencial do cartão SD**.
Os arquivos de log são uma das coisas mais gravadas pelos vários softwares que você instala.
Ao enviar os arquivos para a RAM, você pode controlar a frequência com que eles são gravados no cartão SD. Você ainda poderá acessar esses arquivos na RAM como se estivessem no seu cartão SD.

Copie e cole esta linha no terminal:

Manualmente

    wget https://git.io/log2ram -O Log2Ram-Script.sh && sudo chmod +x Log2Ram-Script.sh && sudo ./Log2Ram-Script.sh

ou

Adicionar fonte de repositório (atualização automática)

    echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian/ bullseye main" | sudo tee /etc/apt/sources.list.d/azlux.list
    sudo wget -O /usr/share/keyrings/azlux-archive-keyring.gpg  https://azlux.fr/repo.gpg
    sudo apt update
    sudo apt install log2ram

# 

<h1 align="center"><b><i>Turn Off Pi LED Lights</b></i> </h1>

Acho que a energia dos LEDs afetará eletricidade e calor desnecessários 🤷😅. Não há necessidade disso de qualquer maneira, se apenas usá-lo como um servidor de rede. Abra o arquivo cron digitando na linha de comando`crontab -e`, copie e cole a linha de comando do trabalho abaixo na parte inferior do arquivo cron e salve.

Verde

    @reboot echo none | sudo tee /sys/class/leds/led0/trigger

Vermelho

    @reboot echo none | sudo tee /sys/class/leds/led1/trigger

Reinicie pi.

# 

<h1 align="center"><b><i>Secure Your Raspberry Pi</b></i> </h1>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><img src="https://i.imgur.com/a9JQVls.png" width=80px height=90px></a>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><b>LINK</b></a>

<i>(Eu apenas uso Fail2Ban e mudo a porta SSH)</i>

**[⬆ VOLTAR AO TOPO ⬆](#contents)**

* * *

<p align="center">
<b>🎉🎉 THAT'S IT !! 🎉🎉 YOUR FINISH 👌👌
<p align="center">
<b>ANY ISSUES, FIXES OR TIPS TO MAKE THESE PROJECTS BETTER PLEASE CONTRIBUTE🤖</b>

* * *

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"
<br> 
<br> 
<br> 

<p align="center">
 <img src="https://i.imgur.com/Q07E7SW.gif" width=500px height=30px>

<p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/stargazers"><img src="https://reporoster.com/stars/dark/trinib/AdGuard-WireGuard-Unbound-Cloudflare"></a>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" </p>

# 

## _Recursos do Repositório_

<h5 https://www.raspberrypi.com/documentation/

<https://github.com/AdguardTeam/AdGuardHome/wiki/Getting-Started>

<https://developers.cloudflare.com/>

<https://docs.pi-hole.net/guides/dns/cloudflared/>

<https://docs.pi-hole.net/guides/dns/unbound/>

<https://nlnetlabs.nl/documentation/unbound/unbound.conf/>

<https://dnsprivacy.org/dns_privacy_clients/>

<https://github.com/anudeepND/pihole-unbound>

<https://github.com/stong/unbound.conf.d>

<https://github.com/Nyr/wireguard-install>

<https://github.com/azlux/log2ram>

* * *

<h4

Faça perguntas frequentes:<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions/17"><b>LINK</b></a>
