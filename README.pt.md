# ![logo](https://i.imgur.com/zqJELkl.png)

<p align="center">
 <img src="https://img.shields.io/badge/License-MIT-blue.svg">
 <img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103">
 <img src="http://ForTheBadge.com/images/badges/built-with-love.svg">
 <img src="https://img.shields.io/badge/badges-awesome-green.svg">
 <img src="https://img.shields.io/badge/Stay-Safe-red?logo=data:image/svg%2bxml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEwIDUxMCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTAgNTEwIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im0xNzQuNjEgMzAwYy0yMC41OCAwLTQwLjU2IDYuOTUtNTYuNjkgMTkuNzJsLTExMC4wOSA4NS43OTd2MTA0LjQ4M2g1My41MjlsNzYuNDcxLTY1aDEyNi44MnYtMTQ1eiIgZmlsbD0iI2ZmZGRjZSIvPjwvZz48cGF0aCBkPSJtNTAyLjE3IDI4NC43MmMwIDguOTUtMy42IDE3Ljg5LTEwLjc4IDI0LjQ2bC0xNDguNTYgMTM1LjgyaC03OC4xOHYtODVoNjguMThsMTE0LjM0LTEwMC4yMWMxMi44Mi0xMS4yMyAzMi4wNi0xMC45MiA0NC41LjczIDcgNi41NSAxMC41IDE1LjM4IDEwLjUgMjQuMnoiIGZpbGw9IiNmZmNjYmQiLz48cGF0aCBkPSJtMzMyLjgzIDM0OS42M3YxMC4zN2gtNjguMTh2LTYwaDE4LjU1YzI3LjQxIDAgNDkuNjMgMjIuMjIgNDkuNjMgNDkuNjN6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTM5OS44IDc3LjN2OC4wMWMwIDIwLjY1LTguMDQgNDAuMDctMjIuNjQgNTQuNjdsLTExMi41MSAxMTIuNTF2LTIyNi42NmwzLjE4LTMuMTljMTQuNi0xNC42IDM0LjAyLTIyLjY0IDU0LjY3LTIyLjY0IDQyLjYyIDAgNzcuMyAzNC42OCA3Ny4zIDc3LjN6IiBmaWxsPSIjZDAwMDUwIi8+PHBhdGggZD0ibTI2NC42NSAyNS44M3YyMjYuNjZsLTExMi41MS0xMTIuNTFjLTE0LjYtMTQuNi0yMi42NC0zNC4wMi0yMi42NC01NC42N3YtOC4wMWMwLTQyLjYyIDM0LjY4LTc3LjMgNzcuMy03Ny4zIDIwLjY1IDAgNDAuMDYgOC4wNCA1NC42NiAyMi42NHoiIGZpbGw9IiNmZjRhNGEiLz48cGF0aCBkPSJtMjEyLjgzIDM2MC4xMnYzMGg1MS44MnYtMzB6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTI2NC42NSAzNjAuMTJ2MzBoMzYuMTRsMzIuMDQtMzB6IiBmaWxsPSIjZmZiZGE5Ii8+PC9nPjwvc3ZnPg==">

</p>
 <p align="center">
     <a href="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge" alt="GitHub Repo stars">
         <img src="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge" alt="GitHub forks">
         <img src="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge" alt="GitHub watchers">
         <img src="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge"></a>
</p>

<h2><p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.zh-CN.md"><b>ğŸ‡¨ğŸ‡³</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.es.md"><b>ğŸ‡ªğŸ‡¸</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.ru.md"><b>ğŸ‡·ğŸ‡º</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.hi.md"><b>ğŸ‡®ğŸ‡³</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.fr.md"><b>ğŸ‡«ğŸ‡·</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.it.md"><b>ğŸ‡®ğŸ‡¹</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.de.md"><b>ğŸ‡©ğŸ‡ª</b></a>&nbsp;<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/lang/README.ar.md"><b>ğŸ‡¦ğŸ‡ª</b></a></h2>

<p align="center"><img src="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/assets/images/awcu.gif" width= "700">

# 

## Recursos

#### _<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>PÃ¡gina inicial do AdGuard</b></a>_: Bloqueie anÃºncios em todos os seus dispositivos(<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md#how-does-adguard-home-compare-to-pi-hole"><b>_comparado ao Pi-Hole_</b></a>)

#### _<a href="https://www.wireguard.com/"><b>WireGuard</b></a>_: Servidor VPN em casa acessÃ­vel a partir de qualquer rede externa (IPv4 e IPv6)

#### <a href="https://www.nlnetlabs.nl/projects/unbound/about/"><b><i>NÃ£o vinculado</i></b></a>com[<i>Atarracado</i>](https://dnsprivacy.org/dns_privacy_daemon_-_stubby/about_stubby/): Um resolvedor de DNS de validaÃ§Ã£o, recursivo e com cache

#### _<a href="https://www.cloudflare.com/learning/what-is-cloudflare/"><b>Cloudflare</b></a>_: Melhor desempenho e seguranÃ§a ao navegar em sites (DoT e DoH)

<i>Todos os softwares sÃ£o gratuitos, de cÃ³digo aberto eÂ auto-hospedadoÂ </i></br><a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/wiki/About"><b>Sobre</b></a>\|<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions/17"><b>Perguntas frequentes</b></a>\|<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki"><b>Wiki</b></a>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 

# 

### Velocidade de consulta DNS com<a href="https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/testingdnsusingdig.htm"><b>Ferramenta de escavaÃ§Ã£o do BIND</b></a>ğŸ§ª

<b>Resultados de google.com em milissegundos:</b>

-   Resolvedores de DNS padrÃ£o do AdGuard -`60-70 msec`
-   Public Cloudflare/Quad9/Google DNS Resolvers -`50-70 msec`
-   Esta instalaÃ§Ã£o/configuraÃ§Ã£o -`5-10 msec`

<details><summary><b>PreviewğŸ¥<img src="https://media.giphy.com/media/WT5h7PgVSScLLKtMaS/giphy.gif" width=50px height=40px></b></summary>
<p>

DNS padrÃ£o do AdGuard<b><i>vs</i></b>esta configuraÃ§Ã£oâ­ :

<https://user-images.githubusercontent.com/18756975/150230438-b767e86f-4e18-4791-b5fe-0813615a37a3.mp4>

Public Cloudflare/Quad9/Google DNS resolvers :

<https://user-images.githubusercontent.com/18756975/150319049-3d8acdc9-624f-4b60-8ee2-b80227522252.mp4>

</p>
</details>

# 

### Ãšltima verificaÃ§Ã£oâ° : 17 de abril de 2022</h2>

<div align="center">

| Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProjetosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StatusÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| :--------------------------------------------------------------: | :--------------------------------------------------------: |
|                     PÃ¡gina inicial do AdGuard                    |                              âœ…                             |
|                           NÃ£o vinculado                          |                              âœ…                             |
|                            Cloudflare                            |                              âœ…                             |
|                            Atarracado                            |                              âœ…                             |
|                             WireGuard                            |                              âœ…                             |

</div>

# Ãndice

-   [Requisitos](#requirements)
-   [Install Raspberry Pi OS](#install-raspberry-pi-os)<img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-icon.svg" width=20px height=20px>
    -   [Acesse o Pi OS com SSH](#access-pi-os-with-ssh)
-   [Instalar AdGuard Home](#install-adguard-home)<img src="https://www.vectorlogo.zone/logos/adguard/adguard-icon.svg" width=20px height=20px>
    -   [Configure seus dispositivos para trabalhar com o Adguard](#set-up-your-devices-to-work-with-adguard)
    -   [Configurando a lista de bloqueio do AdGuard](#setting-up-adguard-blocklist)
        -   [Adicionar/remover vÃ¡rios URLs](#addremove-multiple-urls)
-   [Instalar nÃ£o vinculado](#install-unbound)<img src="https://www.privacytools.io/img/apps/unbound.svg" width=20px height=20px>
-   [Instalar Cloudflare](#install-cloudflare)<img src="https://www.vectorlogo.zone/logos/cloudflare/cloudflare-icon.svg" width=20px height=20px>
    -   [ConfiguraÃ§Ã£o para Cloudflared (DoH)](#setup-for-cloudflared-doh)
    -   [Configurar Cloudflare (DoT) em Unbound](#configure-cloudflare-dot-on-unbound)
        -   [Configurar Stubby para Unbound](#configure-stubby-for-unbound)
        -   [Configurar AdGuard com Cloudflare (DoH&DoT)](#configure-adguard-with-cloudflaredohdot)
-   [Instalar o WireGuard](#install-wireguard)<img src="https://www.vectorlogo.zone/logos/wireguard/wireguard-icon.svg" width=20px height=20px>ou<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md">OpenVPN (mais lento)</a><img src="https://i.imgur.com/Agstbe5.png" width=20px height=20px>
-   [Conectando VPN ao telefone Android/IOS](#connecting-vpn-to-androidios-phone)
-   [Conectando VPN ao Windows](#connecting-vpn-to-windows)
-   [Configurar Wireguard com AdGuard/Unbound/Cloudflare](#configure-wireguard-with-adguardunboundcloudflare)
    -   [Limitar o trÃ¡fego](#limit-traffic)
    -   [Ğ˜Ğ¿Ğ²Ñˆ](#ipv6)
    -   [Desabilitar todos os IPv6](#disable-all-ipv6)
-   [Teste de VPN](#test-vpn)<img src="https://i.imgur.com/6Yf8Zra.png" width=20px height=20px>
-   [Recursos do RepositÃ³rio](#repository-resources)

# 

# Requisitos

Este tutorial Ã© baseado no Raspberry Pi, mas vocÃª pode usar qualquer Linux<a href="https://github.com/thibmaek/awesome-raspberry-pi#os-images"><b>sistema operacional</b></a><i>(pedaÃ§o)</i>, qualquer hardware ou um<a href="https://www.google.com/search?q=What+is+a+VPS+used+for%3F&client=firefox-b-d&biw=1280&bih=582&sxsrf=APq-WBu-yng0bW9IWwNKsQhD6h1ZmRGncw%3A1650151372793&ei=zE9bYpL1L_OOwbkPgZ6DGA&ved=0ahUKEwiSi5rz3Jn3AhVzRzABHQHPAAMQ4dUDCA0&uact=5&oq=What+is+a+VPS+used+for%3F&gs_lcp=Cgdnd3Mtd2l6EAMyBAgAEA0yBAgAEA0yBAgAEA0yBAgAEA0yBggAEA0QHjIGCAAQFhAeMgYIABAWEB4yCAgAEAgQDRAeMggIABAIEA0QHjIICAAQCBANEB46BwgAEEcQsANKBAhBGABKBAhGGABQ8AFY8AFg_ANoAXABeACAAXCIAXCSAQMwLjGYAQCgAQKgAQHIAQjAAQE&sclient=gws-wiz"><b>VPS</b></a>.</br>(Raspberry Pi OS Ã© mais simples e recomendado para Pi ou para usuÃ¡rios mais experientes,<b>DietPi</b>OS tambÃ©m Ã© recomendado)

-   Uma versÃ£o Raspberry Pi 3 ou 4
-   Um roteador que suporta o encaminhamento de porta (Most Can)
-   Leitor de cartÃ£o microSD USB
-   CartÃ£o MicroSD (8 GB ou maior, pelo menos Classe 4)
-   Cabo Ethernet
-   (Opcional se estiver usando monitor) MicroHDMI-(RPi 4) ou HDMI-(RPi 3)

# 

# <i>Install Raspberry Pi OS</b></i>

Raspberry Pi OS vem nas versÃµes desktop e lite (use lite para<a href="https://www.google.com/search?q=What+is+a+headless+operating+system%3F&client=firefox-b-d&sxsrf=APq-WBvlqMZasn_klYxS5HZmhKQlduKYuQ%3A1650123816301&ei=KORaYtz7EYOdwbkP74G16AE&ved=0ahUKEwjcr5-f9pj3AhWDTjABHe9ADR0Q4dUDCA0&uact=5&oq=What+is+a+headless+operating+system%3F&gs_lcp=Cgdnd3Mtd2l6EAMyCAghEBYQHRAeOgcIABBHELADSgQIQRgASgQIRhgAUMEBWMEBYNAEaAFwAXgAgAFqiAFqkgEDMC4xmAEAoAECoAEByAEIwAEB&sclient=gws-wiz"><b>sem cabeÃ§a</b></a>modo). VocÃª pode acessar um Raspberry Pi com um monitor/teclado/mouse ou conectar via<a href="https://www.google.com/search?q=What+is+SSH+in+Linux%3F&client=firefox-b-d&sxsrf=APq-WBsiHvek7g0OrBHWDbEy-x7m-B6O3Q%3A1650481751310&ei=V1pgYoHNEs-uwbkPtI25mAI&ved=0ahUKEwjB1PrTq6P3AhVPVzABHbRGDiMQ4dUDCA0&uact=5&oq=What+is+SSH+in+Linux%3F&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjIGCAAQFhAeMgYIABAWEB4yBggAEBYQHjoHCCMQsAMQJzoHCAAQRxCwAzoHCAAQsAMQQzoKCAAQ5AIQsAMYAToPCC4Q1AIQyAMQsAMQQxgCSgQIQRgASgQIRhgBUM8IWM8IYJAMaAFwAXgAgAFxiAFxkgEDMC4xmAEAoAECoAEByAERwAEB2gEGCAEQARgJ2gEGCAIQARgI&sclient=gws-wiz"><b>ssh</b></a>de um terminal.

Instale o balenEtcher e baixe a imagem Pi para escrever no cartÃ£o microSD.

-   Download Raspberry Pi OS:<https://www.raspberrypi.org/software/operating-systems/>

-   Baixe o BalenaEtcher:<https://www.balena.io/etcher/>

Depois que vocÃª tiver`Etcher`instalado e`Raspberry Pi OS`arquivo baixado, agora vocÃª pode inserir o cartÃ£o SD com leitor de cartÃ£o microSD USB em seu computador.

-   Inicie o Etcher e escolha a imagem do Raspberry Pi OS que vocÃª baixou, selecione seu cartÃ£o microSD e clique`Flash`.

Depois que o flash for concluÃ­do, procure em "Este PC" por um nome de disco "boot ou unidade USB" (reconecte o leitor de cartÃ£o USB se nÃ£o for visto). VÃ¡ para esse disco, crie um novo arquivo de texto chamado**_`ssh without 'txt' extension`_**. Desative â€œOcultar extensÃµes para tipos de arquivo conhecidosâ€ nas opÃ§Ãµes do explorador de arquivos, caso nÃ£o o veja.

<p align="center">
 <img src="https://i.imgur.com/eV6uMbz.jpg">

<i>Coloque o cartÃ£o SD no Raspberry Pi, conecte o cabo Ethernet e inicialize</i>

## Acesse o Pi OS com SSH

-   Aguarde um minuto para a primeira inicializaÃ§Ã£o do Pi

-   Abra o navegador e faÃ§a login na pÃ¡gina do painel do seu roteador

-   Encontre a lista de todos os dispositivos conectados Ã  sua rede e copie o endereÃ§o IP do Raspberry Pi (provavelmente terÃ¡ o nome do host`raspberrypi`)

-   Abra o terminal em sua mÃ¡quina host. VocÃª pode usar o powerShell no Windows ou RaspController para Android.

Digite o seguinte comando:

    ssh pi@pi's IP address

<i>VocÃª pode usar o botÃ£o direito do mouse para colar texto no Windows powerShell</i>.

Digite "yes" para a pergunta de impressÃ£o digital e digite "raspberry" para a senha padrÃ£o (as senhas serÃ£o invisÃ­veis na linha de comando). VocÃª pode digitar**_`sudo passwd pi`_**para alterar a senha depois.

<p align="center">
 <img src="https://i.imgur.com/Wf30jxG.jpg">

Execute no terminal:

    sudo apt update -y && sudo apt upgrade -y

__Reinicie quando terminar__

    sudo reboot

**[â¬† Voltar ao conteÃºdo â¬†](#table-of-contents)**

# 

# <i>Instalar AdGuard Home</b></i>

Este script de instalaÃ§Ã£o Ã© de<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>PÃ¡gina inicial do AdGuard</b></a>projeto principal. Siga para se manter atualizado.

Execute o seguinte comando no seu terminal:

    curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v

-   Quando a instalaÃ§Ã£o estiver concluÃ­da, uma janela aparecerÃ¡ no terminal mostrando`links`para sua pÃ¡gina inicial do AdGuard (ComeÃ§ar)

-   `IMPORTANT:`Na opÃ§Ã£o Ouvir Interfaces escolha`Eth0`e selecione prÃ³ximo

    <p align="center">
     <img src="https://i.imgur.com/Wa00lDp.jpg" width=580px height=690px>

-   Configure nome de usuÃ¡rio e senha e faÃ§a login no painel de administraÃ§Ã£o

-   `IMPORTANT:`Nas configuraÃ§Ãµes gerais, defina "RetenÃ§Ã£o de logs de consulta" como`24 hours`. (Eu li que, para algumas pessoas, os logs sÃ£o preenchidos, o que diminui a velocidade do Pi e precisa de uma reinicializaÃ§Ã£o)

## Configure seus dispositivos para trabalhar com o AdGuard

-   Para Android/Apple, vÃ¡ para configuraÃ§Ãµes avanÃ§adas de WiFi e selecione a opÃ§Ã£o estÃ¡tica. Dentro`DNS 1`campo digite o endereÃ§o "IP do Pi"

    <p align="center">
     <img src="https://i.imgur.com/nxpiqDw.jpg" width=450px height=580px>

-   Para PC/Windows

    -   <i>Ğ˜Ğ¿Ğ²Ñ‡</i>

        VÃ¡ para configuraÃ§Ãµes de rede / altere as opÃ§Ãµes do adaptador e clique com o botÃ£o direito do mouse em propriedades e selecione "Internet Protocol Version 4(TCP/IPv4)". Digite o endereÃ§o IP do Pi em`Preferred DNS`servidor.

    -   <i>IPv6 (necessÃ¡rio para`DoH`&`DoT`para trabalhar mais tarde no guia se estiver usando IPv6 em seu roteador)</i>

        VÃ¡ para "Protocolo de Internet VersÃ£o 6 (TCP/IPv6)" Digite`::1`

`OPTIONAL:`<i>VocÃª pode adicionar um DNS de backup nos campos alternativos</i>

`BE AWARE:`<i>No Android, adicionar um DNS pÃºblico no segundo campo interrompe o bloqueio de anÃºncios do AdGuard</i>

<p align="center">
 <img src="https://i.imgur.com/8gsDk3z.jpg">

## Configurando a lista de bloqueio do AdGuard

Na pÃ¡gina inicial do AdGuard em filtros, selecione a seÃ§Ã£o de lista de bloqueio de DNS para adicionar URLs.

<p align="center">
 <img src="https://i.imgur.com/shrtJLD.png">

Minha lista de bloqueio, por exemplo[<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/My-Blocklist.txt"><b>Clique aqui</b></a>]

**_Fontes de listas de bloqueio finais_**:</br><a href="https://github.com/T145/black-mirror"><img src="https://raw.githubusercontent.com/T145/black-mirror/master/.github/images/logo.png" width=220px height=60px></a>  
<a href="https://github.com/T145/black-mirror"><b>espelho preto</b></a>-_Listas negras de hosts maliciosos mantidas automaticamente e listas brancas de falsos positivos_</br>ğŸ‘Š MUITO OBRIGADO ğŸ‘Š a<a href="https://github.com/T145"><b>T 145</b></a>

`IMPORTANT:`Algumas listas de bloqueio podem bloquear alguns conteÃºdos ou sites importantes. Para desbloquear vÃ¡ na seÃ§Ã£o "Query Log" e verÃ¡_desbloquear_opÃ§Ã£o quando o cursor passa sobre uma consulta, colocando sites desbloqueados no exemplo de "Regras de filtragem personalizadas":`@@||bitly.com^$important`. Procure pelo IP e horÃ¡rio do cliente.

## Adicionar/remover vÃ¡rios URLs

VocÃª sÃ³ pode adicionar um por um URL na lista de bloqueio de DNS com o AdGuard por enquanto, mas hÃ¡ um script python para adicionar vÃ¡rios URLs de uma sÃ³ vez.

Abra um novo arquivo py (bulkurls.py):

    nano bulkurls.py

Em seguida, copie e cole as configuraÃ§Ãµes de script[<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/bulkurls.py"><b>Clique aqui</b></a>]. Definir`your AdGuard credentials`e salve (control+x entÃ£o y entÃ£o enter).

_Se estiver usando**DietPi**instalar`sudo apt-get install python3-pip -y && pip install requests`por nÃ£o instalar por padrÃ£o._

Para correr :`sudo python3 bulkurls.py`

Para**remover**vocÃª precisa mudar`add`dentro<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/62ba01ed8ed3a5bc5294b9fe7ee38c3e83ae1b86/bulkurls.py#L150"><b>segundo da Ãºltima linha</b></a>para`remove`no arquivo bulkurls.py.

Vamos para<https://d3ward.github.io/toolz/adblock.html>para testar se os anÃºncios estÃ£o bloqueando<img src="https://i.imgur.com/Q5oO9EY.png" width=100px height=80px>

**[â¬† Voltar ao conteÃºdo â¬†](#table-of-contents)**

# 

# <i>Instalar nÃ£o vinculado</b></i>

Execute o seguinte comando no seu terminal:

    sudo apt install unbound -y

Para consultar recursivamente um host que nÃ£o estÃ¡ armazenado em cache como um endereÃ§o, o resolvedor precisa iniciar no topo da Ã¡rvore do servidor e consultar os servidores raiz, para saber onde ir para o domÃ­nio de nÃ­vel superior do endereÃ§o que estÃ¡ sendo consultado. Unbound vem com dicas internas padrÃ£o.

    wget -O root.hints https://www.internic.net/domain/named.root && sudo mv root.hints /var/lib/unbound/

`IMPORTANT:`Isso precisa ser atualizado a cada 6 meses. Para_**atualizaÃ§Ã£o automÃ¡tica**_root.hints a cada 6 meses vocÃª precisa criar um cron job.

Entre na linha de comando`crontab -e`, ele pedirÃ¡ para selecionar um editor (escolha 1) e cole essas linhas na parte inferior do crontab e salve (control+x entÃ£o y e digite):

    1 0 1 */6 * wget -O root.hints https://www.internic.net/domain/named.root
    2 0 1 */6 * sudo mv root.hints /var/lib/unbound/

_Se estiver usando**DietPi**vocÃª precisa instalar o resolvconf e reiniciar o unbound-resolvconf.service para definir o servidor de nomes nÃ£o vinculado como 127.0.0.1 :_

    sudo apt-get install resolvconf -y && sudo systemctl restart unbound-resolvconf.service

<p align="center">
 <img src="https://i.imgur.com/26ro62t.jpg">

**[â¬† Voltar ao conteÃºdo â¬†](#table-of-contents)**

# 

# <i>Instalar Cloudflare</b></i>

## ConfiguraÃ§Ã£o para Cloudflared`(DoH)`

[<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki/Install-Cloudflared-service-with-DNS-over-HTTPS-proxy"><b>Clique aqui</b></a>]</h4>

## Configurar Cloudflare`(DoT)`em NÃ£o consolidado

Crie um arquivo de configuraÃ§Ã£o nÃ£o vinculado digitando no prompt de comando:

    sudo nano /etc/unbound/unbound.conf.d/unbound.conf

E copie e cole todo o texto deste arquivo unbound.conf[<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/unbound.conf"><b>Clique aqui</b></a>]e salve (control+x entÃ£o y entÃ£o enter).

## Configurar Stubby para Unbound

Use Unbound para armazenamento em cache e stubby como um encaminhador TLS. Instale atarracado:

    sudo apt install stubby -y

Remova e recrie o arquivo stubby.yaml:

    cd /etc/stubby/ && sudo rm stubby.yml && sudo nano stubby.yml

E copie e cole todo o texto deste arquivo de configuraÃ§Ã£o atarracado[<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/stubby.yml"><b>Clique aqui</b></a>]e salve. (`cd`para retornar Ã  pasta inicial quando terminar).

Reinicie unbound & stubby e verifique o status:

    sudo systemctl restart unbound stubby ; systemctl status unbound stubby -l

<p align="center">
 <img src="https://i.imgur.com/7zIpWP2.jpg" width=650px height=370px>

## Configure o AdGuard com`Cloudflare(DoH&DoT)`

-   Na pÃ¡gina inicial do AdGuard, em configuraÃ§Ãµes, selecione "ConfiguraÃ§Ãµes de DNS"

-   Exclua tudo das opÃ§Ãµes de servidor "Upstream" e "Bootstrap DNS" e digite:

    -   Por`DNS over TLS(DoT)`adicionar`127.0.0.1:53`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`DNS over HTTPS(DoH)`adicionar`127.0.0.1:5053`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`TLS forwarder(stubby)`adicionar`127.0.0.1:8053`nos campos de servidor "Upstream" e "Bootstrap DNS"

-   `IMPORTANT:`VocÃª precisa verificar "<a href="https://adguard.com/en/blog/in-depth-review-adguard-home.html#dns"><b>SolicitaÃ§Ã£o paralela</b></a>" para que os resolvedores de DNS funcionem simultaneamente.

<p align="center">
 <img src="https://i.imgur.com/Ug4Euou.jpg" width=650px height=370px>

-   Em seguida, na configuraÃ§Ã£o de DNS, procure a seÃ§Ã£o de configuraÃ§Ã£o de cache DNS e defina o tamanho do cache para`0`(o armazenamento em cache jÃ¡ Ã© tratado pelo Unbound) e clique em aplicar.

<p align="center">
 <img src="https://i.imgur.com/8Q5Zb0M.jpg" width=650px height=370px>
 
<b>Click apply and test upstreams</b>(might get a error in the first testing only).

#### `IMPORTANT:`O sistema Windows e os navegadores Android precisam de alguns ajustes para`stabilize`Resolvedores de DNS..Linux funciona bem<i>(testado em hortelÃ£)</i>

### janelas

-   Instale o Proxy DNS AcrÃ­lico:<https://mayakron.altervista.org/support/acrylic/Home.htm>

-   Vamos para`C:\Program Files (x86)\Acrylic DNS Proxy`e abra`AcrylicConfiguration.ini`Arquivo. Apague tudo e copie essas configuraÃ§Ãµes[<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/AcrylicConfiguration.ini"><b>Clique aqui</b></a>], apenas altere_**EndereÃ§o do servidor primÃ¡rio**_para o endereÃ§o do seu Pi.

-   Na mesma pasta execute`RestartAcrylicService.bat`&`PurgeAcrylicCacheData.bat`

    `TIP:`Solucionar problemas de comandos IP/DNS

        ipconfig /release
        ipconfig /renew
        ipconfig /flushdns

### Android

-   Em qualquer navegador que vocÃª usa, ligue**fora**`Use Secure DNS`opÃ§Ã£o.
-   Esteja ciente de que os conflitos podem ocorrer com roms e kernels com root personalizados com ajustes de DNS build.prop ou aplicativos/mÃ³dulo Magisk.

#### _Ã‰ isso_. Agora vÃ¡ para<https://1.1.1.1/help>no navegador e vocÃª deve ver essas opÃ§Ãµes como saÃ­da 'Sim'.

-   [x] Conectado a 1.1.1.1
-   [x] DNS sobre HTTPS (DoH)
-   [x] DNS sobre TLS (DoT)
-   [ ] DNS sobre WARP
    <p align="center">
     <img src="https://i.imgur.com/2S3IH5H.jpg" width=650px height=370px>

#### Outros sites para verificar a seguranÃ§a

<https://browserleaks.com/dns>- deve mostrar todos conectados ao "Cloudflare"

<https://www.cloudflare.com/ssl/encrypted-sni/>- "Secure DNS / DNSSEC / TLS 1.3" deve estar com um visto verde

<https://dnssec.vs.uni-due.de/>- deve dizer "Sim, seu resolvedor de DNS valida assinaturas DNSSEC"

**[â¬† Voltar ao conteÃºdo â¬†](#table-of-contents)**

# 

# <i>Instalar o WireGuard</b></i>

**Antes de instalar o WireGuard**, se vocÃª nÃ£o tiver um<a href="https://www.google.com/search?client=firefox-b-d&q=static+IP"><b>I.P. estÃ¡tico</b></a>vocÃª precisa obter gratuitamente`Dynamic DNS Subdomain`ou entÃ£o seu endereÃ§o IP externo muda dinamicamente do seu ISP, entÃ£o vocÃª precisarÃ¡ configurar um serviÃ§o DNS dinÃ¢mico[**<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki/Create-a-Dynamic-DNS-Hostname-Service"><b>Clique aqui</b></a>**]. Ou entÃ£o pule a etapa.

VocÃª tambÃ©m precisa configurar<a href="https://www.google.com/search?q=What+is+port+forwarding+used+for%3F&client=firefox-b-d&sxsrf=APq-WBuwPqGlPJ6N9_l6qpQ3e5sYoUxZAQ%3A1650219365125&ei=ZVlcYo6sB6SGwbkP8tGOwA8&ved=0ahUKEwjO8ryY2pv3AhUkQzABHfKoA_gQ4dUDCA0&uact=5&oq=What+is+port+forwarding+used+for%3F&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEBYQHjoHCAAQRxCwAzoHCAAQsAMQQ0oECEEYAEoECEYYAFDMAVjMAWCBBWgBcAF4AIABbIgBbJIBAzAuMZgBAKABAqABAcgBCsABAQ&sclient=gws-wiz"><b>encaminhamento de porta</b></a>no seu roteador para que vocÃª possa acessar a rede WireGuard em qualquer lugar, como um hotspot de uma cafeteria e atÃ© mesmo de tethering de dados mÃ³veis.
TIPO | VALOR  
------------ \| -------------
Dispositivo | Nome de host ou IP do Raspberry Pi
Protocolo | UDP
Faixa de portas | 51820-51820
Porto de saÃ­da | 51820
Permitir acesso Ã  Internet (se tiver) | sim

ConfiguraÃ§Ã£o da porta do meu ğŸ‘‡roteadorğŸ‘‡. O seu pode ser diferente, mas vocÃª vai conseguir. Lembre-se de que o ğŸ”mecanismo de pesquisağŸ” do Google Ã© seu amigo. Se vocÃª nÃ£o conseguir se conectar de uma rede externa, o que significa que o ISP bloqueou as conexÃµes de saÃ­da, vocÃª pode ligar para eles e pedir gentilmente para fazÃª-lo funcionar.

<p align="center">
 <img src="https://i.imgur.com/9LBEk1i.jpg">

* * *

ğŸ‘ŠMUITO OBRIGADOğŸ‘Š por este script de instalaÃ§Ã£o de<a href="https://github.com/Nyr/wireguard-install"><b>Nova</b></a>. Siga para se manter atualizado.

Executar no terminal

    wget https://git.io/wireguard -O wireguard-install.sh && sudo bash wireguard-install.sh

-   O script solicitarÃ¡ IPv4/nome de host pÃºblico para a VPN._Se_vocÃª tem IP estÃ¡tico, entÃ£o continue ou digite o domÃ­nio DNS dinÃ¢mico que vocÃª criou a partir do<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki/Create-a-Dynamic-DNS-Hostname-Service"><b>instruÃ§Ãµes</b></a>. Por exemplo: trinibvpn.freeddns.org

-   Para opÃ§Ã£o de porta`press enter`para o padrÃ£o 51820. Para o nome do cliente, basta colocar o nome que quiser, e para o DNS use a opÃ§Ã£o 3 (`1.1.1.1`) por enquanto. VocÃª vai configurar`AdGuard/Unbound/Cloudflare`com a VPN apÃ³s sua instalaÃ§Ã£o concluÃ­da.

<p align="center">
 <img src="https://i.imgur.com/WUNZIK4.jpg">

-   Aguarde atÃ© que a instalaÃ§Ã£o termine e o cÃ³digo QR apareÃ§a, nÃ£o feche. Mas se vocÃª fizer isso, para`regenerate qrcode`, digite no terminal, mas substituindo apenas o nome`yourclientname.conf`arquivo para o seu:


    sudo cp /root/yourclientname.conf /home/pi && sudo qrencode -t ansiutf8 < yourclientname.conf

`IMPORTANT:`VocÃª precisarÃ¡ adicionar um novo usuÃ¡rio/cliente para cada dispositivo usado com a VPN. Para adicionar um novo usuÃ¡rio, basta executar novamente o script e criar um usuÃ¡rio com um nome de cliente diferente.

<b>Usar_OpenVPN_</b>[<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki/Install-OpenVPN"><b>Clique aqui</b></a>]

# 

### Conectando VPN ao telefone Android/IOS

Instale o aplicativo WireGuard do Google Play ou App Store:

WireGuard (Google Play):<https://play.google.com/store/apps/details?id=com.wireguard.android>

WireGuard (App Store):<https://apps.apple.com/us/app/wireguard/id1441195209>

VocÃª precisa digitalizar o cÃ³digo QR mostrado no terminal com o aplicativo WireGuard, selecione o`+ button`e use a opÃ§Ã£o`Scan from QR code`para instalar a configuraÃ§Ã£o.

`IMPORTANT`: Habilitar**back-end do mÃ³dulo do kernel**nas configuraÃ§Ãµes

<p align="left">
 <img src="https://i.imgur.com/R4qbiOQ.jpg" width=250px height=350px>

### Conectando VPN ao Windows

WireGuard para janelas:<https://download.wireguard.com/windows-client/wireguard-installer.exe>

-   Criar uma`new text document`com qualquer nome no PV para copiar e colar o texto do arquivo de configuraÃ§Ã£o do cliente WireGuard.

-   Para ver o texto no arquivo de configuraÃ§Ã£o do cliente, digite terminal:


    sudo cat /root/yourclientname.conf

-   Realce todo o texto, copie e cole no arquivo txt no PC e salve. Em seguida, renomeie a extensÃ£o de`txt`para`conf`. Agora vocÃª tem o arquivo de configuraÃ§Ã£o para esse cliente WireGuard.

-   Agora vocÃª pode importar o arquivo de configuraÃ§Ã£o para o WireGuard (opÃ§Ã£o importar do arquivo).

## Configure o WireGuard com`Adguard/Unbound/Cloudflare`

_Lembre-se que isso Ã© para quando vocÃª estiver conectado ao WireGuard VPN em uma rede externa ou em casa 24 horas por dia, 7 dias por semana, porque vocÃª jÃ¡ tem o AdGuard/Unbound/Cloudflare configurado e em execuÃ§Ã£o em seus dispositivos manualmente._(nÃ£o hÃ¡ problema em ter ambos configurados para minha experiÃªncia)

-   No aplicativo WireGuard, selecione seu tÃºnel e selecione editar (lÃ¡pis no canto superior direito)

-   Em servidores DNS, insira`Pi's IP`e salve (IPv4 e IPv6)

<p align="center">
 <img src="https://i.imgur.com/UC0vWfE.jpg" width=450px height=500px>  

### Limitar o trÃ¡fego

Com o WireGuard, vocÃª perderÃ¡ cerca de 50% da velocidade da internet, pois o processo de encapsulamento do Pi para o roteador para os dispositivos\*\*

Excluir nos IPs permitidos a opÃ§Ã£o "0.0.0.0/0, ::/0" porque ela roteia todo o trÃ¡fego para sua rede domÃ©stica, o que serÃ¡ lento. VocÃª precisa enviar trÃ¡fego apenas atravÃ©s de seus endereÃ§os.

-   Primeiro vocÃª precisa substituÃ­-lo pelo seu gateway de rede, mas definindo o Ãºltimo nÃºmero como zero e<a href="https://www.google.com/search?q=prefix+length+explained&client=firefox-b-d&sxsrf=ALeKk036Jc9vJl73zVXf0yyZs5UlKRlNRQ%3A1621083125589&ei=9cOfYI66I5-qwbkPkdWxkAk&oq=prefix+length+explained&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAcQHjoHCCMQsAMQJzoHCAAQRxCwA1CUJ1iUJ2CiKmgBcAJ4AIABsAGIAdQCkgEDMC4ymAEAoAEBqgEHZ3dzLXdpesgBCcABAQ&sclient=gws-wiz&ved=0ahUKEwjOiOie3cvwAhUfVTABHZFqDJIQ4dUDCA0&uact=5"><b>comprimento do prefixo</b></a>a 24. Por exemplo:`192.168.1.1/24`para`192.168.1.0/24`ou como meu roteador ISP`192.168.100.1/24`para`192.168.100.0/24`.~~**Agora eu sÃ³ perco 25% de velocidade**ğŸ˜ (PS. usando rede 5g)~~

`UPDATE:`ApÃ³s uma atualizaÃ§Ã£o do WireGuard, nÃ£o consigo uma velocidade mais rÃ¡pida fazendo issoğŸ˜ .. mas ainda faz sentido_nÃ£o_usar`"0.0.0.0/0, ::/0`com Wi-Fi. Se alguÃ©m souber de algum ajuste para obter um impulso, me avise.

<p align="center">
 <img src="https://i.imgur.com/x4m6Pbl.jpg" width=450px height=500px>

### POR FAVOR LEIA !! , ESTAR CIENTE !!

`IMPORTANT`:_Se sua rede possui endereÃ§os IP para dispositivos que terminam com um nÃºmero de 3 dÃ­gitos (mais de 24), por exemplo: 192.168.100.`254`, vocÃª nÃ£o poderÃ¡ rotear corretamente a partir da rede externa porque a aplicaÃ§Ã£o de 24 permite apenas os nÃºmeros de 1 a 24. Em vez disso, vocÃª precisa colocar`0`para rotear fora do intervalo 24, por exemplo:`192.168.100.0/0`_.

Ou vocÃª pode alterar o intervalo de IP no seu roteador (na minha experiÃªncia, vocÃª pode obter velocidades um pouco melhores porque ele nÃ£o rotearÃ¡ endereÃ§os IP permitidos desnecessÃ¡rios no intervalo de 24).

<p align="center">
 <img src="https://i.imgur.com/ZZ4aMUI.jpg" width=750px height=550px>

## Ğ˜Ğ¿Ğ²Ñˆ

Se vocÃª estiver usando IPv6, quando estiver conectado ao WiFi, precisarÃ¡ inserir os IPs permitidos do WireGuard`fe80::1/0`tambÃ©m. Por exemplo`192.168.100.0/0, fe80::1/0`

Quando conectado ao cabo Ethernet em um PC com Windows, vocÃª precisa inserir`::1`no endereÃ§o IPv6 no servidor DNS preferencial "Internet Protocol Version 6(TCP/IPv6)".

EntÃ£o vÃ¡ para<https://ipv6leak.com/>e vocÃª deve ver "_Seu IPv6 nÃ£o estÃ¡ vazando_".

# 

## Desabilitar todos os IPv6

#### Desative o IPv6 se vocÃª nÃ£o tiver ou nÃ£o quiser[<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/wiki/Disable-all-IPv6"><b>Clique aqui</b></a>]. Como resultado, se vocÃª tiver uma internet fraca, desabilitar o IPv6 pode acelerar a solicitaÃ§Ã£o de dns, mas terÃ¡ menos seguranÃ§a.

# 

## Testar VPN

Como vocÃª sabe se o WireGuard VPN estÃ¡ realmente funcionando?

Por**janelas**Baixe o Wireshark:<https://www.wireshark.org/#download>

Uma vez baixado, vocÃª pode usar o aplicativo para inspecionar seus pacotes de dados onde o protocolo estÃ¡ definido para o usado pelo WireGuard VPN. Quando um trÃ¡fego de pacotes Ã©`encrypted`, pode ser lido assim, por exemplo:

<p align="center">
 <img src="https://i.imgur.com/Tn4M47R.jpg">

Por**andrÃ³ide**vocÃª pode usar o PCAPdroid:<https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture&hl=en&gl=US>

VocÃª deve ver todas as conexÃµes`closed`e status mostrando todas as conexÃµes DNS e nÃ£o todas as conexÃµes TLS em todos os aplicativos. (abra e use aplicativos para PCAPdroid para escanear)

**[â¬† Voltar ao conteÃºdo â¬†](#table-of-contents)**

* * *

<b>QUALQUER PROBLEMA, CORREÃ‡ÃƒO OU DICAS PARA MELHORAR ESSES PROJETOS, CONTRIBUA ğŸ¤–</b>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"
<br> 
<br> 
<br> 

<p align="center">
 <img src="https://i.imgur.com/Q07E7SW.gif" width=500px height=30px>

<p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/stargazers"><img src="https://reporoster.com/stars/dark/trinib/AdGuard-WireGuard-Unbound-Cloudflare"></a>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"</p>

# 

## _Recursos do RepositÃ³rio_

<h5 https://www.raspberrypi.com/documentation/

<https://github.com/AdguardTeam/AdGuardHome/wiki/Getting-Started>

<https://developers.cloudflare.com/>

<https://docs.pi-hole.net/guides/dns/cloudflared/>

<https://docs.pi-hole.net/guides/dns/unbound/>

<https://nlnetlabs.nl/documentation/unbound/unbound.conf/>

<https://dnsprivacy.org/dns_privacy_clients/>

<https://github.com/anudeepND/pihole-unbound>

<https://github.com/stong/unbound.conf.d>

<https://github.com/Nyr/wireguard-install>

<https://github.com/T145/black-mirror>
