# ![logo](https://i.imgur.com/zqJELkl.png)

<p align="center">
 <img src="https://img.shields.io/badge/License-MIT-blue.svg">
 <img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103">
 <img src="http://ForTheBadge.com/images/badges/built-with-love.svg">
 <img src="https://img.shields.io/badge/badges-awesome-green.svg">
 <img src="https://img.shields.io/badge/Stay-Safe-red?logo=data:image/svg%2bxml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTEwIDUxMCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCA1MTAgNTEwIiB3aWR0aD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxnPjxwYXRoIGQ9Im0xNzQuNjEgMzAwYy0yMC41OCAwLTQwLjU2IDYuOTUtNTYuNjkgMTkuNzJsLTExMC4wOSA4NS43OTd2MTA0LjQ4M2g1My41MjlsNzYuNDcxLTY1aDEyNi44MnYtMTQ1eiIgZmlsbD0iI2ZmZGRjZSIvPjwvZz48cGF0aCBkPSJtNTAyLjE3IDI4NC43MmMwIDguOTUtMy42IDE3Ljg5LTEwLjc4IDI0LjQ2bC0xNDguNTYgMTM1LjgyaC03OC4xOHYtODVoNjguMThsMTE0LjM0LTEwMC4yMWMxMi44Mi0xMS4yMyAzMi4wNi0xMC45MiA0NC41LjczIDcgNi41NSAxMC41IDE1LjM4IDEwLjUgMjQuMnoiIGZpbGw9IiNmZmNjYmQiLz48cGF0aCBkPSJtMzMyLjgzIDM0OS42M3YxMC4zN2gtNjguMTh2LTYwaDE4LjU1YzI3LjQxIDAgNDkuNjMgMjIuMjIgNDkuNjMgNDkuNjN6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTM5OS44IDc3LjN2OC4wMWMwIDIwLjY1LTguMDQgNDAuMDctMjIuNjQgNTQuNjdsLTExMi41MSAxMTIuNTF2LTIyNi42NmwzLjE4LTMuMTljMTQuNi0xNC42IDM0LjAyLTIyLjY0IDU0LjY3LTIyLjY0IDQyLjYyIDAgNzcuMyAzNC42OCA3Ny4zIDc3LjN6IiBmaWxsPSIjZDAwMDUwIi8+PHBhdGggZD0ibTI2NC42NSAyNS44M3YyMjYuNjZsLTExMi41MS0xMTIuNTFjLTE0LjYtMTQuNi0yMi42NC0zNC4wMi0yMi42NC01NC42N3YtOC4wMWMwLTQyLjYyIDM0LjY4LTc3LjMgNzcuMy03Ny4zIDIwLjY1IDAgNDAuMDYgOC4wNCA1NC42NiAyMi42NHoiIGZpbGw9IiNmZjRhNGEiLz48cGF0aCBkPSJtMjEyLjgzIDM2MC4xMnYzMGg1MS44MnYtMzB6IiBmaWxsPSIjZmZjY2JkIi8+PHBhdGggZD0ibTI2NC42NSAzNjAuMTJ2MzBoMzYuMTRsMzIuMDQtMzB6IiBmaWxsPSIjZmZiZGE5Ii8+PC9nPjwvc3ZnPg==">

</p>
 <p align="center">
     <a href="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge" alt="GitHub Repo stars">
         <img src="https://img.shields.io/github/stars/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=FFD700&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge" alt="GitHub forks">
         <img src="https://img.shields.io/github/forks/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=00a671&style=for-the-badge"></a>
     <a href="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge" alt="GitHub watchers">
         <img src="https://img.shields.io/github/watchers/trinib/AdGuard-WireGuard-Unbound-Cloudflare?color=9700b2&style=for-the-badge"></a>
</p>

<p align="center">
 <img src="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/assets/images/awcu.gif" width= "700">

#### _<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>AdGuard</b></a>_: Adblocker para seus dispositivos em casa (<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md#how-does-adguard-home-compare-to-pi-hole"><b>_AdGuard comparado ao Pi-Hole_</b></a>)

#### _<a href="https://www.wireguard.com/"><b>WireGuard</b></a>_: Um servidor VPN em casa acessÃ­vel a partir de qualquer rede externa (IPv4 e IPv6)

#### _<a href="https://www.nlnetlabs.nl/projects/unbound/about/"><b>NÃ£o vinculado</b></a>com &lt;a href="<https://dnsprivacy.org/dns_privacy_daemon>_-_atarracado/sobre_atarracado/"><b>Atarracado</b></a>_: Um resolvedor de DNS de validaÃ§Ã£o, recursivo e de cache

#### _<a href="https://www.cloudflare.com/learning/what-is-cloudflare/"><b>Cloudflare</b></a>_: Melhor desempenho e seguranÃ§a ao navegar em sites (DoT e DoH)

* * *

# 

<h2 align="left">ğŸ§ª Speed results with <a href="https://docs.oracle.com/en-us/iaas/Content/DNS/Tasks/testingdnsusingdig.htm"><b>BIND's DNS Tool </b></a> ğŸ§ª</h1>

<b>Tempo de consulta (google.com) em milissegundos:</b>

-   Resolvedores de DNS padrÃ£o do Adguard -`60-70 msec`
-   Resolvedores de DNS pÃºblicos da Cloudflare/Quad9/Google -`50-70 msec`
-   Esta instalaÃ§Ã£o/configuraÃ§Ã£o -`5-10 msec`

<details><summary><b>ğŸ¥Video PreviewsğŸ¥<img src="https://media.giphy.com/media/WT5h7PgVSScLLKtMaS/giphy.gif" width=50px height=40px></b></summary>
<p>

### ã€Adguard DNS padrÃ£oã€‘<i>VS</i>â­esta configuraÃ§Ã£oâ­ :

<https://user-images.githubusercontent.com/18756975/150230438-b767e86f-4e18-4791-b5fe-0813615a37a3.mp4>

### Resolvedores de DNS pÃºblicosã€cloudflare/quad9/googleã€‘:

<https://user-images.githubusercontent.com/18756975/150319049-3d8acdc9-624f-4b60-8ee2-b80227522252.mp4>

</p>
 </details>

* * *

<h4><p align="center">
â°Last Checked : 25 Feb 2022â°</h2>

<div align="center">

| Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProjetosÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  | Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StatusÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  |
| :--------------------------------------------------------------: | :--------------------------------------------------------: |
|                     PÃ¡gina inicial do AdGuard                    |                              âœ…                             |
|                           NÃ£o vinculado                          |                              âœ…                             |
|                            Cloudflare                            |                              âœ…                             |
|                            Atarracado                            |                              âœ…                             |
|                             WireGuard                            |                              âœ…                             |

</div>
<div>

# 

# ConteÃºdo

-   <a href="https://git.io/About">Sobre</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/parrots/party-nyan.gif" width=20px height=20px>
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions">DiscussÃµes/F.A.Q</a><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-speech-balloon.png" width=20px height=20px>
-   [Requisitos](#requirements)
-   [Instalando o sistema operacional Pi](#installing-os-image-to-sdcard-)<img src="https://www.vectorlogo.zone/logos/raspberrypi/raspberrypi-icon.svg" width=20px height=20px>
    -   [Fazendo login no sistema Pi \[sem cabeÃ§a\]](#-logging-into-pi-system-headlessly-)
-   [Instalando o AdGuard](#adguard-install-)<img src="https://www.vectorlogo.zone/logos/adguard/adguard-icon.svg" width=20px height=20px>
    -   [Configure seus dispositivos para trabalhar com o Adguard](#-set-up-your-devices-to-work-with-adguard-)
    -   [Configurando a lista de bloqueio do AdGuard](#-setting-up-adguard-blocklist-)
        -   [Adicionar/remover vÃ¡rios URLs Ã  lista de bloqueio de uma sÃ³ vez](#-addremove-multiple-urls-)
-   [Instalando Unbound](#unbound-install-)<img src="https://www.privacytools.io/img/apps/unbound.svg" width=20px height=20px>
-   [Instalando o Cloudflare](#cloudflare-install-)<img src="https://www.vectorlogo.zone/logos/cloudflare/cloudflare-icon.svg" width=20px height=20px>
    -   [Instale o Cloudflare (DoH)](#-install-cloudflare-on-pi-with-doh-)
    -   [Configurar Cloudflare em Unbound (DoT)](#-configure-cloudflare-on-unbound-with-dot-)
    -   [Configurar Stubby (Encaminhador TLS)](#-configure-stubby-for-unbound-)
    -   [Configurar AdGuard com Cloudflare (DoH&DoT)](#-configure-adguard-with-cloudflaredohdot-)
-   [Instalando o WireGuard](#wireguard-install-)<img src="https://www.vectorlogo.zone/logos/wireguard/wireguard-icon.svg" width=20px height=20px>ou<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md">OpenVPN (mais lento)</a><img src="https://i.imgur.com/Agstbe5.png" width=20px height=20px>
    -   [Conectando-se Ã  VPN ao telefone Android/IOS](#-connecting-to-the-vpn-to-androidios-phone-)
    -   [Conectando-se Ã  VPN a partir de um PC (Windows)](#-connecting-to-the-vpn-from-a-pc-windows-)
    -   [Configurar Wireguard com AdGuard/Unbound/Cloudflare](#-configure-wireguard-with-adguardunboundcloudflare-)
        -   [Limitar o trÃ¡fego](#limit-traffic)
        -   [ConfiguraÃ§Ã£o IPv6](#ipv6)
-   <a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md">Desabilitar todos os IPv6</a>
-   [Teste de VPN](#how-do-you-know-if-wireguard-vpn-is-really-working-)<img src="https://i.imgur.com/6Yf8Zra.png" width=20px height=20px>
-   [Atualize automaticamente seu Pi](#auto-update-pi-)
-   [Melhorando a vida Ãºtil potencial do seu cartÃ£o SD](#log2ram-install-)
-   [Desligue os LEDs Pi](#turn-off-pi-led-lights-)
-   [Protegendo seu Raspberry Pi](#secure-your-raspberry-pi-)
-   [Recursos do RepositÃ³rio](#repository-resources)<img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-books.png" width=20px height=20px>

# 

# Requisitos

-   Uma versÃ£o Raspberry Pi 3 ou 4
-   Um roteador que suporta o encaminhamento de porta (Most Can)
-   Leitor de cartÃ£o microSD USB
-   CartÃ£o MicroSD (8 GB ou maior, pelo menos Classe 4)
-   Cabo Ethernet
-   (Opcional se estiver usando monitor) MicroHDMI-(RPi 4) ou HDMI-(RPi 3)

    # 

    <p align="center">
      <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 1 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Installing OS Image To SDcard</b></i> </h1>

Este tutorial Ã© baseado no Raspberry Pi OS, mas vocÃª pode usar qualquer linux<a href="https://github.com/thibmaek/awesome-raspberry-pi#os-images"><b>sistema operacional</b></a>(32 bits ou 64 bits) e hardware de sua preferÃªncia com alguns ajustes_**se vocÃª sabe o que estÃ¡ fazendo**_! (Raspberry Pi OS Ã© mais simples e recomendado para Pi ou para usuÃ¡rios mais experientes,_DietPi OS_tambÃ©m Ã© recomendado).

O Raspberry Pi OS vem nas versÃµes Desktop e Lite (use lite apenas para o modo headless). VocÃª pode configurar o Raspberry Pi com um monitor/teclado/mouse ou configurÃ¡-lo â€œsem cabeÃ§aâ€ a partir de um terminal.

Instale o balenEtcher e baixe a imagem pi para escrever no cartÃ£o microSD.

-   Download Raspberry Pi OS:<https://www.raspberrypi.org/software/operating-systems/>

-   Baixar baleiaEtcher:<https://www.balena.io/etcher/>

Depois que vocÃª tiver`Etcher`instalado e`Raspberry Pi OS`arquivo baixado em seu computador, agora vocÃª pode inserir o cartÃ£o SD com leitor de cartÃ£o microSD USB em seu computador.

Inicie o Etcher e escolha a imagem do Raspberry Pi OS que vocÃª baixou, selecione seu cartÃ£o microSD e clique em â€œFlashâ€.

<p align="center">
 <img src="https://i.imgur.com/tbB3VIK.jpg">

Depois que o flash for concluÃ­do, procure em "Este PC" por um nome de disco "boot or usb drive" (reconecte o leitor de cartÃ£o usb se nÃ£o for visto). VÃ¡ para esse disco, crie um novo arquivo de texto chamado**_`ssh without 'txt' extention`_**. CUIDADO, nÃ£o Ã© â€œssh.txtâ€, Ã© â€œsshâ€ sem a extensÃ£o. VocÃª precisa desabilitar a opÃ§Ã£o â€œOcultar extensÃµes para tipos de arquivos conhecidosâ€ nas OpÃ§Ãµes do Explorador de Arquivos se nÃ£o as vir.

<p align="center">
 <img src="https://i.imgur.com/eV6uMbz.jpg">

Agora coloque o cartÃ£o SD no Raspberry Pi, conecte o cabo Ethernet e inicialize.

## â•¸ Entrando no sistema Pi[Sem cabeÃ§a]â•¸

-   Agora vocÃª precisa esperar um minuto para a primeira inicializaÃ§Ã£o do pi

-   Abra o navegador e faÃ§a login na pÃ¡gina do painel do seu roteador

-   Encontre a lista de todos os dispositivos conectados Ã  sua rede e copie o endereÃ§o IP do Raspberry Pi (provavelmente terÃ¡ o nome do host`raspberrypi`)

-   Abra o Terminal em sua mÃ¡quina host. VocÃª pode usar o PowerShell no Windows ou RaspController para Android

Digite o seguinte comando:

    ssh pi@pi's ip address

VocÃª pode usar o botÃ£o direito do mouse para colar texto no Windows PowerShell.

Digite "yes" para a pergunta de impressÃ£o digital e digite "raspberry" para uma senha. As senhas serÃ£o invisÃ­veis ao digitar na interface linux. VocÃª pode digitar**_`sudo passwd pi`_**para alterar a senha.

<p align="center">
 <img src="https://i.imgur.com/Wf30jxG.jpg">

Execute no terminal:

    sudo apt update -y && sudo apt upgrade -y

__AGUARDE ATUALIZAÃ‡ÃƒO PARA TERMINAR e REINICIAR PI. ENTÃƒO CONTINUE PARA O PRÃ“XIMO PASSO__.....

    sudo reboot

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 2 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>AdGuard Install</b></i> </h1>

Este script de instalaÃ§Ã£o Ã© de<a href="https://github.com/AdguardTeam/AdGuardHome/blob/master/README.md"><b>PÃ¡gina inicial do AdGuard</b></a>projeto principal. Siga para se manter atualizado.

Execute o seguinte comando no seu terminal:

    curl -s -S -L https://raw.githubusercontent.com/AdguardTeam/AdGuardHome/master/scripts/install.sh | sh -s -- -v

-   Quando a instalaÃ§Ã£o estiver concluÃ­da, uma janela aparecerÃ¡ no terminal mostrando os diferentes links para a pÃ¡gina inicial do SEU Adguard (ComeÃ§ar)

-   `IMPORTANT:`Na opÃ§Ã£o Ouvir Interfaces escolha`Eth0`e selecione prÃ³ximo

<p align="center">
  <img src="https://i.imgur.com/Wa00lDp.jpg" width=580px height=690px>

-   Configurar nome de usuÃ¡rio e senha

-   Agora vocÃª deve estar no painel inicial do Adguard

-   `IMPORTANT:`Nas configuraÃ§Ãµes gerais, defina "RetenÃ§Ã£o de logs de consulta" como`24 hours`(Eu li que, para algumas pessoas, os logs enchem e diminuem a velocidade do pi e precisam ser reiniciados sempre)

## â•¸ Configure seus dispositivos para trabalhar com o Adguard â•¸

-   Para Android/Apple, vÃ¡ para configuraÃ§Ãµes avanÃ§adas de wifi e selecione a opÃ§Ã£o estÃ¡tica. Dentro`DNS 1`campo digite o endereÃ§o "ip do pi"

    <p align="center">
     <img src="https://i.imgur.com/nxpiqDw.jpg" width=450px height=580px>

-   Para PC/Windows

    -   <i>IPV4</i>

        VÃ¡ para configuraÃ§Ãµes de rede / altere as opÃ§Ãµes do adaptador e clique com o botÃ£o direito do mouse em propriedades e selecione "Internet Protocol Version 4(TCP/IPv4)". Digite o endereÃ§o IP do pi em`Preferred DNS`servidor

    -   <i>IPV6 (necessÃ¡rio para`DoH`&`DoT`para trabalhar mais tarde no guia se estiver usando ipv6 no seu roteador)</i>

        VÃ¡ para "Protocolo de Internet VersÃ£o 6 (TCP/IPv6)" Digite`::1`

`OPTIONAL:`<i>VocÃª pode adicionar um DNS de backup nos campos alternativos</i>

`BE AWARE:`<i>No Android, adicionar um DNS pÃºblico no segundo campo quebra o bloqueio de anÃºncios do Adguard</i>

<p align="center">
 <img src="https://i.imgur.com/8gsDk3z.jpg">

## â•¸ Configurando a lista de bloqueio do AdGuard â•¸

Na pÃ¡gina inicial do AdGuard, em filtros, selecione a seÃ§Ã£o de lista de bloqueio DNS para adicionar URLs.

<p align="center">
 <img src="https://i.imgur.com/shrtJLD.png">

VocÃª pode pesquisar no Google por uma lista de bloqueio diferente.Aqui estÃ¡ minha customizaÃ§Ã£o<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/My-Blocklist.txt"><b>lista de bloqueio</b></a>com meus urls ou crie o seu prÃ³prio a partir destes<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/%F0%9F%A7%B1Blocklist-Sources%E2%84%B9%EF%B8%8F"><b>origens</b></a>.

`IMPORTANT:`Algumas listas de bloqueio podem bloquear alguns conteÃºdos ou sites importantes. Para desbloquear vÃ¡ na seÃ§Ã£o "Query Log" e verÃ¡_desbloquear_opÃ§Ã£o quando o cursor passa sobre uma consulta, colocando sites desbloqueados no exemplo de "Regras de filtragem personalizadas":`@@||bitly.com^$important`. Procure o ip e horÃ¡rio do cliente.

<p align="center">
 <img src="https://i.imgur.com/1gZibwD.png">

## â•¸ Adicionar/Remover vÃ¡rios URLs â•¸

VocÃª sÃ³ pode adicionar um por um URL na lista de bloqueio dns no adguard por enquanto, mas hÃ¡ um script python para adicionar vÃ¡rios URLs juntos.

Abra um novo arquivo py (bulkurls.py):

    nano bulkurls.py

Em seguida, copie e cole o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/bulkurls.py"><b>bulkurls.py</b></a>arquivo e salve (control+x entÃ£o y entÃ£o enter)**PRECISA CONFIGURAR SUAS CREDENCIAIS DE ADGUARD NO ARQUIVO**.

_Se estiver usando**DietPi**instalar`sudo apt-get install python3-pip -y && pip install requests`por nÃ£o instalar por padrÃ£o._

Para correr :`sudo python3 bulkurls.py`

Para**remover**vocÃª precisa mudar`add`dentro<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/62ba01ed8ed3a5bc5294b9fe7ee38c3e83ae1b86/bulkurls.py#L150"><b>segundo da Ãºltima linha</b></a>para`remove`no arquivo bulkurls.py.

Vamos para<https://d3ward.github.io/toolz/adblock.html>para testar se os anÃºncios estÃ£o bloqueando<img src="https://i.imgur.com/Q5oO9EY.png" width=100px height=80px>

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 3 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>Unbound Install</b></i> </h1>

Execute o seguinte comando no seu terminal:

    sudo apt install unbound -y

Para consultar recursivamente um host que nÃ£o estÃ¡ armazenado em cache como um endereÃ§o, o resolvedor precisa iniciar no topo da Ã¡rvore do servidor e consultar os servidores raiz, para saber onde ir para o domÃ­nio de nÃ­vel superior do endereÃ§o que estÃ¡ sendo consultado. Unbound vem com dicas internas padrÃ£o.

    wget -O root.hints https://www.internic.net/domain/named.root && sudo mv root.hints /var/lib/unbound/

`IMPORTANT:`Isso precisa ser atualizado a cada 6 meses. Para_**atualizaÃ§Ã£o automÃ¡tica**_root.hints a cada 6 meses vocÃª precisa criar um cron job.

Entre na linha de comando`crontab -e`, ele perguntarÃ¡ Selecione um editor (escolha 1) e cole essas linhas na parte inferior do crontab e salve (control+x entÃ£o y e digite):

    1 0 1 */6 * wget -O root.hints https://www.internic.net/domain/named.root
    2 0 1 */6 * sudo mv root.hints /var/lib/unbound/

_Se estiver usando**DietPi**vocÃª precisa instalar o resolvconf e reiniciar o unbound-resolvconf.service para definir o servidor de nomes nÃ£o vinculado como 127.0.0.1 :_

    sudo apt-get install resolvconf -y && sudo systemctl restart unbound-resolvconf.service

<p align="center">
 <img src="https://i.imgur.com/26ro62t.jpg">

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 4 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>   

<h1 align="center"><b><i>Cloudflare Install</b></i> </h1>

## â•¸ Instale o Cloudflare no Pi com`(DoH)`â•¸

Instale o cloudflare com DNS sobre HTTPS (DoH), siga estes ğŸ‘‰<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Cloudflare-DoH-Setup.md"><b>INSTRUÃ‡Ã•ES</b></a>ğŸ‘ˆ.

## â•¸ Configurar Cloudflare em Unbound With`(DoT)`â•¸

Crie um arquivo de configuraÃ§Ã£o nÃ£o vinculado digitando no prompt de comando:

    sudo nano /etc/unbound/unbound.conf.d/unbound.conf

E copie e cole todo o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/unbound.conf"><b>unbound.conf</b></a>arquivo e salve (control+x entÃ£o y entÃ£o enter).

## â•¸ Configurar Stubby para Unbound â•¸

Use Unbound para armazenamento em cache e stubby para encaminhador TLS. Instale atarracado:

    sudo apt install stubby -y

Remova e recrie o arquivo stubby.yaml e copie/cole todo o texto de<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/stubby.yml"><b>ğŸ‘‰ esta configuraÃ§Ã£o atarracada ğŸ‘ˆ</b></a>e salve. (`cd $h`para retornar Ã  pasta inicial quando terminar).

    cd /etc/stubby/ && sudo rm stubby.yml && sudo nano stubby.yml

-   Reinicie o unbound & stubby e verifique o status:


    sudo systemctl restart unbound stubby ; systemctl status unbound stubby -l

<p align="center">
 <img src="https://i.imgur.com/7zIpWP2.jpg" width=650px height=370px>

## â•¸ Configurar Adguard com`Cloudflare(DoH&DoT)`â•¸

-   Na pÃ¡gina inicial do AdGuard, em configuraÃ§Ãµes, selecione "ConfiguraÃ§Ãµes de DNS"

-   Exclua tudo das opÃ§Ãµes de servidor "Upstream" e "Bootstrap DNS" e:

    -   Por`DNS over TLS(DoT)`adicionar`127.0.0.1:53`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`DNS over HTTPS(DoH)`adicionar`127.0.0.1:5053`nos campos de servidor "Upstream" e "Bootstrap DNS"
    -   Por`TLS forwarder(stubby)`adicionar`127.0.0.1:8053`nos campos de servidor "Upstream" e "Bootstrap DNS"

-   `IMPORTANT:`VocÃª precisa verificar "<a href="https://adguard.com/en/blog/in-depth-review-adguard-home.html#dns"><b>SolicitaÃ§Ã£o paralela</b></a>" opÃ§Ã£o para os resolvedores de dns funcionarem simultaneamente.

<b>Clique em aplicar e teste upstreams</b>(pode obter um erro apenas no primeiro teste).

<p align="center">
 <img src="https://i.imgur.com/Ug4Euou.jpg" width=650px height=370px>

-   Em seguida, na configuraÃ§Ã£o de DNS, procure a seÃ§Ã£o de configuraÃ§Ã£o de cache DNS e defina o tamanho do cache para`0`(o armazenamento em cache jÃ¡ Ã© tratado pelo Unbound) e clique em aplicar.

<p align="center">
 <img src="https://i.imgur.com/8Q5Zb0M.jpg" width=650px height=370px>

### `IMPORTANT:`O sistema Windows e os navegadores Android precisam de alguns ajustes para`stabilize`resolvedores de DNS..Linux funciona bem<i>(testado em hortelÃ£)</i>

### janelas

-   Instalar<a href="https://mayakron.altervista.org/support/acrylic/Home.htm"><b>Proxy DNS acrÃ­lico</b></a>

-   Vamos para`C:\Program Files (x86)\Acrylic DNS Proxy`e abra`AcrylicConfiguration.ini`Arquivo. Apague tudo e copie estes<a href="https://raw.githubusercontent.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/main/AcrylicConfiguration.ini"><b>ğŸ‘‰CONFIGURAÃ‡Ã•ESğŸ‘ˆ</b></a>sÃ³ mudar_**EndereÃ§osServidorPrimÃ¡rio**_para o endereÃ§o do seu pi.

-   Na mesma pasta execute`RestartAcrylicService.bat`&`PurgeAcrylicCacheData.bat`

    `TIP:`Solucionar problemas de comandos IP/DNS

        ipconfig /release
        ipconfig /renew
        ipconfig /flushdns

### Android

-   Em qualquer navegador que vocÃª usa, ligue**fora**`Use Secure DNS`opÃ§Ã£o.
-   Esteja ciente de que os conflitos podem ocorrer com roms e kernels com root personalizados com ajustes de dns do build.prop ou aplicativos/mÃ³dulo Magisk.

#### _Ã‰ isso_. Agora vÃ¡ para<https://1.1.1.1/help>no navegador e vocÃª deve ver essas opÃ§Ãµes como saÃ­da 'Sim'.

-   [x] Conectado a 1.1.1.1
-   [x] DNS sobre HTTPS (DoH)
-   [x] DNS sobre TLS (DoT)
-   [ ] DNS sobre WARP
    <p align="center">
     <img src="https://i.imgur.com/2S3IH5H.jpg" width=650px height=370px>

#### Outros sites para verificar a seguranÃ§a

<https://browserleaks.com/dns>- deve mostrar todos conectados ao "Cloudflare"

<https://www.cloudflare.com/ssl/encrypted-sni/>- "Secure DNS / DNSSEC / TLS 1.3" deve estar com um visto verde

<https://dnssec.vs.uni-due.de/>- deve dizer "Sim, seu resolvedor de DNS valida assinaturas DNSSEC"

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

# 

<p align="center">
 <b><img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px> STEP 5 <img src="https://github.com/seanprashad/slackmoji/blob/master/emoji/party/party-footprints.png" width=20px height=20px></b>

<h1 align="center"><b><i>WireGuard Install</b></i> </h1>

**Antes de instalar o WireGuard**, se vocÃª nÃ£o tiver um ip estÃ¡tico, vocÃª precisa obter um`Dynamic DNS Subdomain`ou entÃ£o seu endereÃ§o IP externo provavelmente muda dinamicamente de seu ISP com muita frequÃªncia e, por esse motivo, vocÃª precisarÃ¡ configurar um serviÃ§o DNS dinÃ¢mico. ğŸ‘‰ğŸ‘‰**_â–“â–’â–‘Use este<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>INSTRUÃ‡Ã•ES AQUI</b></a>â–‘â–’â–“_**ğŸ‘ˆğŸ‘ˆ. Ou entÃ£o pule a etapa.

TambÃ©m precisamos configurar o encaminhamento de porta em seu roteador para que possamos acessar o wireguard fora de nossa rede, como em um hotspot de cafÃ© ou seus dados mÃ³veis
TIPO | VALOR  
------------ \| -------------
Dispositivo | Nome de host ou IP do Raspberry Pi
Protocolo | UDP
Faixa de portas | 51820-51820
Porto de saÃ­da | 51820
Permitir acesso Ã  Internet (se tiver) | sim

ConfiguraÃ§Ã£o da porta do meu ğŸ‘‡roteadorğŸ‘‡. O seu pode ser diferente, mas vocÃª vai conseguir. Lembre-se de que o ğŸ”mecanismo de pesquisağŸ” do Google Ã© seu amigo. Se vocÃª nÃ£o puder se conectar de uma rede externa, o que significa que o isp bloqueou as conexÃµes de saÃ­da, vocÃª pode ligar para eles e pedir gentilmente para fazÃª-lo funcionar.

<p align="center">
 <img src="https://i.imgur.com/9LBEk1i.jpg">

* * *

ğŸ‘ŠMUITO OBRIGADOğŸ‘Š por este script de instalaÃ§Ã£o de<a href="https://github.com/Nyr/wireguard-install"><b>Nova</b></a>. Siga para se manter atualizado.

Executar no terminal

    wget https://git.io/wireguard -O wireguard-install.sh && sudo bash wireguard-install.sh

-   O script solicitarÃ¡ IPv4/nome de host pÃºblico para a VPN._Se_vocÃª tem ip estÃ¡tico, entÃ£o continue ou digite o domÃ­nio DNS dinÃ¢mico que vocÃª criou a partir do<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/Dns-Service-Guide.md"><b>instruÃ§Ãµes</b></a>. Por exemplo: trinibvpn.freeddns.org

-   Para opÃ§Ã£o de porta`press enter`para o padrÃ£o 51820. Para o nome do cliente, basta colocar o nome que quiser, e para o DNS use a opÃ§Ã£o 3 (`1.1.1.1`) por enquanto. NÃ³s vamos configurar`adguard/unbound/cloudflare`com o vpn depois de instalado

<p align="center">
 <img src="https://i.imgur.com/WUNZIK4.jpg">

-   Aguarde atÃ© que a instalaÃ§Ã£o termine e o cÃ³digo QR apareÃ§a, nÃ£o feche. Mas se vocÃª fizer isso, para`regenerate qrcode`, digite no terminal, mas substituindo apenas o nome`yourclientname.conf`arquivo para o seu:


    sudo cp /root/yourclientname.conf /home/pi && sudo qrencode -t ansiutf8 < yourclientname.conf

`IMPORTANT:`VocÃª precisarÃ¡ adicionar um novo usuÃ¡rio/cliente para cada dispositivo usado com a VPN. Para adicionar um novo usuÃ¡rio, basta executar novamente o script e criar um usuÃ¡rio com um nome de cliente diferente.

## Se vocÃª quiser usar_OpenVPN_as instruÃ§Ãµes sÃ£o<a href="https://github.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/blob/main/OpenVPN-Setup.md"><b>ğŸ‘‰aquiğŸ‘ˆ</b></a>

# 

### â•¸ Conectando-se Ã  VPN ao telefone Android/IOS â•¸

Instale o aplicativo WireGuard do Google Play ou App Store

ProteÃ§Ã£o de fio (Google Play):<https://play.google.com/store/apps/details?id=com.wireguard.android>

Wireguard (App Store):<https://apps.apple.com/us/app/wireguard/id1441195209>

VocÃª precisa digitalizar o cÃ³digo QR mostrado no terminal com o aplicativo Wireguard, selecione o`+ button`e use a opÃ§Ã£o`Scan from QR code`para instalar a configuraÃ§Ã£o.

`IMPORTANT`: Habilitar**back-end do mÃ³dulo do kernel**nas configuraÃ§Ãµes

<p align="left">
 <img src="https://i.imgur.com/R4qbiOQ.jpg" width=250px height=350px>

### â•¸ Conectando-se Ã  VPN de um PC (Windows) â•¸

WireGuard para janelas:<https://download.wireguard.com/windows-client/wireguard-installer.exe>

-   Criar uma`new text document`com qualquer nome no pc para copiar e colar o texto do arquivo de configuraÃ§Ã£o do cliente wireguard.

-   Para ver o texto no arquivo de configuraÃ§Ã£o do cliente, digite terminal:


    sudo cat /root/yourclientname.conf

-   Realce todo o texto, copie e cole no arquivo txt no pc e salve. Em seguida, renomeie a extensÃ£o de`txt`para`conf`. Agora vocÃª tem o arquivo de configuraÃ§Ã£o para esse cliente wireguard.

-   Agora vocÃª pode importar o arquivo de configuraÃ§Ã£o para o wireguard (opÃ§Ã£o importar do arquivo).

## â•¸ Configure o WireGuard com`Adguard/Unbound/Cloudflare`â•¸

_Lembre-se que isso Ã© para quando vocÃª estiver conectado ao WireGuard VPN em uma rede externa ou em casa 24 horas por dia, 7 dias por semana, porque vocÃª jÃ¡ tem o AdGuard/Unbound/Cloudflare configurado e em execuÃ§Ã£o em seus dispositivos manualmente._(nÃ£o hÃ¡ problema em ter ambos configurados para minha experiÃªncia).

-   No aplicativo wireguard, selecione seu tÃºnel e selecione editar (lÃ¡pis no canto superior direito)

-   Em servidores DNS, insira`pi's ip`e salve (IPv4 e IPv6)

<p align="center">
 <img src="https://i.imgur.com/UC0vWfE.jpg" width=450px height=500px>  

### Limitar o trÃ¡fego

Com o WireGuard, vocÃª perderÃ¡ cerca de 50% da velocidade da internet, pois o processo de encapsulamento do pi para o roteador para os dispositivos\*\*

Excluir nos IPs permitidos a opÃ§Ã£o "0.0.0.0/0, ::/0" porque ela roteia todo o trÃ¡fego para sua rede domÃ©stica, o que serÃ¡ lento. VocÃª precisa enviar trÃ¡fego apenas atravÃ©s de seus endereÃ§os.

-   Primeiro vocÃª precisa substituÃ­-lo pelo seu gateway de rede, mas definindo o Ãºltimo nÃºmero como zero e<a href="https://www.google.com/search?q=prefix+length+explained&client=firefox-b-d&sxsrf=ALeKk036Jc9vJl73zVXf0yyZs5UlKRlNRQ%3A1621083125589&ei=9cOfYI66I5-qwbkPkdWxkAk&oq=prefix+length+explained&gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAcQHjoHCCMQsAMQJzoHCAAQRxCwA1CUJ1iUJ2CiKmgBcAJ4AIABsAGIAdQCkgEDMC4ymAEAoAEBqgEHZ3dzLXdpesgBCcABAQ&sclient=gws-wiz&ved=0ahUKEwjOiOie3cvwAhUfVTABHZFqDJIQ4dUDCA0&uact=5"><b>comprimento do prefixo</b></a>a 24. Por exemplo:`192.168.1.1/24`para`192.168.1.0/24`ou como meu roteador ISP`192.168.100.1/24`para`192.168.100.0/24`.~~**Agora eu sÃ³ perco 25% de velocidade**ğŸ˜ (ps. usando rede 5g)~~

`UPDATE:`ApÃ³s uma atualizaÃ§Ã£o do Wireguard, nÃ£o consigo uma velocidade mais rÃ¡pida fazendo isso :( .. mas ainda faz sentido_nÃ£o_usar`"0.0.0.0/0, ::/0`com wi-fi. Se alguÃ©m souber de algum ajuste para obter um impulso, me avise.

<p align="center">
 <img src="https://i.imgur.com/x4m6Pbl.jpg" width=450px height=500px>

### POR FAVOR LEIA !! , ESTAR CIENTE !!

`IMPORTANT`:_Se sua rede possui endereÃ§os IP para dispositivos que terminam com um nÃºmero de 3 dÃ­gitos (mais de 24), por exemplo: 192.168.100.`999`, vocÃª nÃ£o poderÃ¡ rotear corretamente a partir da rede externa porque a aplicaÃ§Ã£o de 24 permite apenas os nÃºmeros de 1 a 24. Em vez disso, vocÃª precisa colocar`0`para rotear fora do intervalo 24, por exemplo:`192.168.100.0/0`_.

Ou vocÃª pode alterar o intervalo de ip no seu roteador (na minha experiÃªncia, vocÃª pode obter velocidades um pouco melhores porque ele nÃ£o rotearÃ¡ endereÃ§os ip permitidos desnecessÃ¡rios no intervalo 24).

<p align="center">
 <img src="https://i.imgur.com/ZZ4aMUI.jpg" width=750px height=550px>

## IPV6

Se vocÃª estiver usando IPv6, quando estiver conectado ao wifi, precisarÃ¡ inserir os IPs permitidos do WireGuard`fe80::1/0`tambÃ©m. Por exemplo`192.168.100.0/0, fe80::1/0`

Quando conectado ao cabo ethernet em um PC com Windows, vocÃª precisa inserir`::1`no endereÃ§o IPv6 no servidor DNS preferencial "Internet Protocol Version 6(TCP/IPv6)".

EntÃ£o vÃ¡ para<https://ipv6leak.com/>e vocÃª deve ver "_Seu IPv6 nÃ£o estÃ¡ vazando_".

# 

<h1 align="left"><a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/blob/main/Disable-All-IPv6.md"><b>Disable all IPv6</b></a></h2>

# 

## Como vocÃª sabe se a VPN wireguard estÃ¡ realmente funcionando?

Por**janelas**download<a href="https://www.wireshark.org/#download."><b>Wireshark</b></a>

Uma vez baixado, vocÃª pode usar o aplicativo para inspecionar seus pacotes de dados onde o protocolo estÃ¡ definido para o usado pelo Wireguard VPN. Quando um trÃ¡fego de pacotes Ã©`encrypted`, pode ser lido assim, por exemplo:

<p align="center">
 <img src="https://i.imgur.com/Tn4M47R.jpg">

Por**andrÃ³ide**vocÃª pode usar<a href="https://play.google.com/store/apps/details?id=com.emanuelef.remote_capture&hl=en&gl=US"><b>PCAPdroid</b></a>. VocÃª deve ver todas as conexÃµes`closed`e status mostrando todas as conexÃµes DNS e nÃ£o todas as conexÃµes TLS em todos os aplicativos (abra e use aplicativos para PCAPdroid para verificar).

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

* * *

# 

<h1 align="center"><b><i>Auto Update Pi</b></i> </h1>

-   Abra um novo arquivo sh chamado update e copie e cole o texto de<a href="https://raw.githubusercontent.com/trinib/Adguard-Wireguard-Unbound-Cloudflare/main/update.sh"><b>ğŸ‘‰aquiğŸ‘ˆ</b></a>


    sudo nano update.sh

-   Definir permissÃ£o


    sudo chmod 700 update.sh

-   Abra o arquivo cron digitando na linha de comando`crontab -e`, copie e cole a linha de comando do trabalho abaixo na parte inferior do arquivo cron e salve.


    0 3 * * WED sudo ./update.sh 2>&1 >/home/pi/updatelog

O Pi agora serÃ¡ atualizado todas as quartas-feiras Ã s 3h. Ou vocÃª pode ir para<https://crontab.guru/>e defina o seu prÃ³prio horÃ¡rio.

Ajuste a data/fuso horÃ¡rio do pi no terminal:

    sudo dpkg-reconfigure tzdata

ou definir manualmente

    sudo date -s "25 DEC 2012 11:14:00"

# 

<h1 align="center"><b><i>Log2Ram Install</b></i> </h1>

Uma das vantagens mais significativas de descarregar sua memÃ³ria RAM Ã© que melhora sua**Vida Ãºtil potencial do cartÃ£o SD**.
Os arquivos de log sÃ£o uma das coisas mais gravadas pelos vÃ¡rios softwares que vocÃª instala.
Ao enviar os arquivos para a RAM, vocÃª pode controlar a frequÃªncia com que eles sÃ£o gravados no cartÃ£o SD. VocÃª ainda poderÃ¡ acessar esses arquivos na RAM como se estivessem no seu cartÃ£o SD.

Copie e cole esta linha no terminal:

Manualmente

    wget https://git.io/log2ram -O Log2Ram-Script.sh && sudo chmod +x Log2Ram-Script.sh && sudo ./Log2Ram-Script.sh

ou

Adicionar fonte de repositÃ³rio (atualizaÃ§Ã£o automÃ¡tica)

    echo "deb [signed-by=/usr/share/keyrings/azlux-archive-keyring.gpg] http://packages.azlux.fr/debian/ bullseye main" | sudo tee /etc/apt/sources.list.d/azlux.list
    sudo wget -O /usr/share/keyrings/azlux-archive-keyring.gpg  https://azlux.fr/repo.gpg
    sudo apt update
    sudo apt install log2ram

# 

<h1 align="center"><b><i>Turn Off Pi LED Lights</b></i> </h1>

Acho que a energia dos LEDs afetarÃ¡ eletricidade e calor desnecessÃ¡rios ğŸ¤·ğŸ˜…. NÃ£o hÃ¡ necessidade disso de qualquer maneira, se apenas usÃ¡-lo como um servidor de rede. Abra o arquivo cron digitando na linha de comando`crontab -e`, copie e cole a linha de comando do trabalho abaixo na parte inferior do arquivo cron e salve.

Verde

    @reboot echo none | sudo tee /sys/class/leds/led0/trigger

Vermelho

    @reboot echo none | sudo tee /sys/class/leds/led1/trigger

Reinicie pi.

# 

<h1 align="center"><b><i>Secure Your Raspberry Pi</b></i> </h1>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><img src="https://i.imgur.com/a9JQVls.png" width=80px height=90px></a>
<p align="center">
<a href="https://gist.github.com/boseji/c9e91ff3bd0b3cfb62a5e260fe505374"><b>LINK</b></a>

<i>(Eu apenas uso Fail2Ban e mudo a porta SSH)</i>

**[â¬† VOLTAR AO TOPO â¬†](#contents)**

* * *

<p align="center">
<b>ğŸ‰ğŸ‰ THAT'S IT !! ğŸ‰ğŸ‰ YOUR FINISH ğŸ‘ŒğŸ‘Œ
<p align="center">
<b>ANY ISSUES, FIXES OR TIPS TO MAKE THESE PROJECTS BETTER PLEASE CONTRIBUTEğŸ¤–</b>

* * *

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif"
<br> 
<br> 
<br> 

<p align="center">
 <img src="https://i.imgur.com/Q07E7SW.gif" width=500px height=30px>

<p align="center">
<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/stargazers"><img src="https://reporoster.com/stars/dark/trinib/AdGuard-WireGuard-Unbound-Cloudflare"></a>

<p align="center">
<img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" </p>

# 

## _Recursos do RepositÃ³rio_

<h5 https://www.raspberrypi.com/documentation/

<https://github.com/AdguardTeam/AdGuardHome/wiki/Getting-Started>

<https://developers.cloudflare.com/>

<https://docs.pi-hole.net/guides/dns/cloudflared/>

<https://docs.pi-hole.net/guides/dns/unbound/>

<https://nlnetlabs.nl/documentation/unbound/unbound.conf/>

<https://dnsprivacy.org/dns_privacy_clients/>

<https://github.com/anudeepND/pihole-unbound>

<https://github.com/stong/unbound.conf.d>

<https://github.com/Nyr/wireguard-install>

<https://github.com/azlux/log2ram>

* * *

<h4

FaÃ§a perguntas frequentes:<a href="https://github.com/trinib/AdGuard-WireGuard-Unbound-Cloudflare/discussions/17"><b>LINK</b></a>
